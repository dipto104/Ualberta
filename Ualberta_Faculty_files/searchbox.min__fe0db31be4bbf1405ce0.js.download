webpackJsonpCoveo__temporary([9,10,11,79],{132:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(52),s=n(52);t.notWordStart=" ()[],$@'\"",t.notInWord=" ()[],:",t.Basic={basicExpressions:["Word","DoubleQuoted"],grammars:{DoubleQuoted:'"[NotDoubleQuote]"',NotDoubleQuote:/[^"]*/,SingleQuoted:"'[NotSingleQuote]'",NotSingleQuote:/[^']*/,Number:/-?(0|[1-9]\d*)(\.\d+)?/,Word:function(e,n,o){var r=RegExp("[^"+t.notWordStart.replace(/(.)/g,"\\$1")+"][^"+t.notInWord.replace(/(.)/g,"\\$1")+"]*"),u=e.match(r);null!=u&&0!=u.index&&(u=null);var a=new i.Result(null!=u?u[0]:null,o,e);return a.isSuccess()&&n&&e.length>a.value.length?new s.EndOfInputResult(a):a}}}},138:function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),n(565);var o=n(11),r=n(99),u=n(3),a=n(175),l=n(221),c=n(5),p=n(18),h=n(13),g=n(6),d=n(1),f=n(10),y=n(7),m=n(8),b=n(2),x=n(509),v=n(510),S=function(e){function t(n,i,s){var u=e.call(this,n,t.ID,s)||this;u.element=n,u.options=i,u.bindings=s,n instanceof HTMLInputElement&&u.logger.error("Querybox cannot be used on an HTMLInputElement"),u.options=m.ComponentOptions.initComponentOptions(n,t,i),new x.QueryboxOptionsProcessing(u).postProcess(),d.$$(u.element).toggleClass("coveo-query-syntax-disabled",!1==u.options.enableQuerySyntax),u.magicBox=l.createMagicBox(n,new a.Grammar("Query",{Query:"[Term*][Spaces?]",Term:"[Spaces?][Word]",Spaces:/ +/,Word:/[^ ]+/}),{inline:!0});var c=d.$$(u.magicBox.element).find("input");return c&&d.$$(c).setAttribute("aria-label",u.options.placeholder||g.l("Search")),u.bind.onRootElement(o.QueryEvents.buildingQuery,function(e){return u.handleBuildingQuery(e)}),u.bind.onRootElement(r.StandaloneSearchInterfaceEvents.beforeRedirect,function(){return u.updateQueryState()}),u.bind.onQueryState(p.MODEL_EVENTS.CHANGE_ONE,h.QUERY_STATE_ATTRIBUTES.Q,function(e){return u.handleQueryStateChanged(e)}),u.options.enableSearchAsYouType&&(d.$$(u.element).addClass("coveo-search-as-you-type"),u.magicBox.onchange=function(){u.searchAsYouType()}),u.magicBox.onsubmit=function(){u.submit()},u.magicBox.onblur=function(){u.updateQueryState()},u.magicBox.onclear=function(){u.updateQueryState(),u.options.triggerQueryOnClear&&(u.usageAnalytics.logSearchEvent(f.analyticsActionCauseList.searchboxClear,{}),u.triggerNewQuery(!1))},u}return s(t,e),t.prototype.submit=function(){this.magicBox.clearSuggestion(),this.updateQueryState(),this.usageAnalytics.logSearchEvent(f.analyticsActionCauseList.searchboxSubmit,{}),this.triggerNewQuery(!1)},t.prototype.setText=function(e){this.magicBox.setText(e),this.updateQueryState()},t.prototype.clear=function(){this.magicBox.clear()},t.prototype.getText=function(){return this.magicBox.getText()},t.prototype.getResult=function(){return this.magicBox.getResult()},t.prototype.getDisplayedResult=function(){return this.magicBox.getDisplayedResult()},t.prototype.getCursor=function(){return this.magicBox.getCursor()},t.prototype.resultAtCursor=function(e){return this.magicBox.resultAtCursor(e)},t.prototype.handleBuildingQuery=function(e){c.Assert.exists(e),c.Assert.exists(e.queryBuilder),this.updateQueryState(),this.lastQuery=this.magicBox.getText(),new v.QueryboxQueryParameters(this.options).addParameters(e.queryBuilder,this.lastQuery)},t.prototype.triggerNewQuery=function(e){clearTimeout(this.searchAsYouTypeTimeout);var t=this.magicBox.getText();this.lastQuery!=t&&null!=t&&(this.lastQuery=t,this.queryController.executeQuery({searchAsYouType:e,logInActionsHistory:!0}))},t.prototype.updateQueryState=function(){this.queryStateModel.set(h.QueryStateModel.attributesEnum.q,this.magicBox.getText())},t.prototype.handleQueryStateChanged=function(e){c.Assert.exists(e);var t=e.value;t!=this.magicBox.getText()&&this.magicBox.setText(t)},t.prototype.searchAsYouType=function(){var e=this;clearTimeout(this.searchAsYouTypeTimeout),this.searchAsYouTypeTimeout=window.setTimeout(function(){e.usageAnalytics.logSearchAsYouType(f.analyticsActionCauseList.searchboxAsYouType,{}),e.triggerNewQuery(!0)},this.options.searchAsYouTypeDelay)},t.ID="Querybox",t.doExport=function(){u.exportGlobally({Querybox:t,QueryboxQueryParameters:v.QueryboxQueryParameters})},t.options={enableSearchAsYouType:m.ComponentOptions.buildBooleanOption({defaultValue:!1,section:"Advanced Options"}),searchAsYouTypeDelay:m.ComponentOptions.buildNumberOption({defaultValue:50,min:0,section:"Advanced Options"}),enableQuerySyntax:m.ComponentOptions.buildBooleanOption({defaultValue:!1,section:"Advanced Options"}),enableWildcards:m.ComponentOptions.buildBooleanOption({defaultValue:!1,section:"Advanced Options"}),enableQuestionMarks:m.ComponentOptions.buildBooleanOption({defaultValue:!1,depend:"enableWildcards"}),enableLowercaseOperators:m.ComponentOptions.buildBooleanOption({defaultValue:!1,depend:"enableQuerySyntax"}),enablePartialMatch:m.ComponentOptions.buildBooleanOption({defaultValue:!1}),partialMatchKeywords:m.ComponentOptions.buildNumberOption({defaultValue:5,min:1,depend:"enablePartialMatch"}),partialMatchThreshold:m.ComponentOptions.buildStringOption({defaultValue:"50%",depend:"enablePartialMatch"}),triggerQueryOnClear:m.ComponentOptions.buildBooleanOption({defaultValue:!1})},t}(y.Component);t.Querybox=S,b.Initialization.registerAutoCreateComponent(S)},175:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(491),s=n(493),o=n(495),r=n(0),u=n(496),a=n(218),l=n(497),c=function(){function e(e,t){void 0===t&&(t={}),this.expressions={},this.start=new i.ExpressionRef(e,null,"start",this),this.addExpressions(t)}return e.prototype.addExpressions=function(e){var t=this;r.each(e,function(e,n){t.addExpression(n,e)})},e.prototype.addExpression=function(t,n){if(t in this.expressions)throw Error("Grammar already contain the id:"+t);this.expressions[t]=e.buildExpression(n,t,this)},e.prototype.getExpression=function(e){return this.expressions[e]},e.prototype.parse=function(e){return this.start.parse(e,!0)},e.buildExpression=function(e,t,n){if(void 0===e)throw Error("Invalid Expression: "+e);if(r.isString(e))return this.buildStringExpression(e,t,n);if(r.isArray(e))return new s.ExpressionOptions(r.map(e,function(e,s){return new i.ExpressionRef(e,null,t+"_"+s,n)}),t);if(r.isRegExp(e))return new o.ExpressionRegExp(e,t,n);if(r.isFunction(e))return new u.ExpressionFunction(e,t,n);throw Error("Invalid Expression: "+e)},e.buildStringExpression=function(t,n,s){var o=e.stringMatch(t,e.spliter),u=r.map(o,function(e,t){if(!e[1])return new a.ExpressionConstant(e[4],n+"_"+t);var o=e[1],r=e[3]?Number(e[3]):e[2]||null;return new i.ExpressionRef(o,r,n+"_"+t,s)});if(1!=u.length)return new l.ExpressionList(u,n);var c=u[0];return c.id=n,c},e.stringMatch=function(e,t){for(var n=[],i=RegExp(t.source,"g"),s=i.exec(e);null!==s;)n.push(s),s=i.exec(e);return n},e.spliter=/\[(\w+)(\*|\+|\?|\{([1-9][0-9]*)\})?\]|(.[^\[]*)/,e}();t.Grammar=c},192:function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e};Object.defineProperty(t,"__esModule",{value:!0}),n(573);var r=n(0),u=n(0),a=n(35),l=n(34),c=n(11),p=n(99),h=n(3),g=n(175),d=n(506),f=n(507),y=n(221),m=n(5),b=n(28),x=n(18),v=n(13),S=n(6),$=n(1),E=n(4),w=n(10),C=n(127),A=n(125),O=n(7),Q=n(8),_=n(2),R=n(138),P=n(509),T=n(510),B=n(19),M=n(574),F=n(575),D=n(576),N=n(577),I=function(e){function t(n,i,s){var o=e.call(this,n,t.ID,s)||this;o.element=n,o.options=i,o.lastSuggestions=[],o.movedOnce=!1,o.skipAutoSuggest=!1,o.options=Q.ComponentOptions.initComponentOptions(n,t,i);var r=o.options.enableQuerySyntax;return new P.QueryboxOptionsProcessing(o).postProcess(),o.omniboxAnalytics=o.searchInterface.getOmniboxAnalytics(),$.$$(o.element).toggleClass("coveo-query-syntax-disabled",!1==o.options.enableQuerySyntax),o.suggestionAddon=o.options.enableQuerySuggestAddon?new N.QuerySuggestAddon(o):new N.VoidQuerySuggestAddon,new F.OldOmniboxAddon(o),o.createMagicBox(),o.bind.onRootElement(c.QueryEvents.newQuery,function(e){return o.handleNewQuery(e)}),o.bind.onRootElement(c.QueryEvents.buildingQuery,function(e){return o.handleBuildingQuery(e)}),o.bind.onRootElement(p.StandaloneSearchInterfaceEvents.beforeRedirect,function(){return o.handleBeforeRedirect()}),o.bind.onRootElement(c.QueryEvents.querySuccess,function(){return o.handleQuerySuccess()}),o.bind.onQueryState(x.MODEL_EVENTS.CHANGE_ONE,v.QUERY_STATE_ATTRIBUTES.Q,function(e){return o.handleQueryStateChanged(e)}),o.isAutoSuggestion()&&o.bind.onRootElement(c.QueryEvents.duringQuery,function(e){return o.handleDuringQuery(e)}),o.bind.onComponentOptions(x.MODEL_EVENTS.CHANGE_ONE,b.COMPONENT_OPTIONS_ATTRIBUTES.SEARCH_BOX,function(e){null!=e.value.enableQuerySyntax?o.options.enableQuerySyntax=e.value.enableQuerySyntax:o.options.enableQuerySyntax=r,o.updateGrammar()}),o.bind.onRootElement(l.OmniboxEvents.querySuggestGetFocus,function(e){return o.handleQuerySuggestGetFocus(e)}),o}return s(t,e),t.prototype.submit=function(){var e=this;this.magicBox.clearSuggestion(),this.updateQueryState(),this.triggerNewQuery(!1,function(){A.logSearchBoxSubmitEvent(e.usageAnalytics)}),this.magicBox.blur()},t.prototype.getText=function(){return this.magicBox.getText()},t.prototype.setText=function(e){this.magicBox.setText(e),this.updateQueryState()},t.prototype.clear=function(){this.magicBox.clear()},t.prototype.getInput=function(){return this.magicBox.element.querySelector("input")},t.prototype.getResult=function(){return this.magicBox.getResult()},t.prototype.getDisplayedResult=function(){return this.magicBox.getDisplayedResult()},t.prototype.getCursor=function(){return this.magicBox.getCursor()},t.prototype.resultAtCursor=function(e){return this.magicBox.resultAtCursor(e)},t.prototype.createGrammar=function(){var e=null;return this.options.enableQuerySyntax?(e=f.Expressions(d.Complete),this.options.enableFieldAddon&&new M.FieldAddon(this),null!=this.options.fieldAlias&&(this.options.listOfFields=this.options.listOfFields||[],this.options.listOfFields=this.options.listOfFields.concat(r.keys(this.options.fieldAlias))),this.options.enableQueryExtensionAddon&&new D.QueryExtensionAddon(this)):e={start:"Any",expressions:{Any:/.*/}},null!=this.options.grammar&&(e=this.options.grammar(e)),e},t.prototype.updateGrammar=function(){var e=this.createGrammar();this.magicBox.grammar=new g.Grammar(e.start,e.expressions),this.magicBox.setText(this.magicBox.getText())},t.prototype.createMagicBox=function(){var e=this.createGrammar();this.magicBox=y.createMagicBox(this.element,new g.Grammar(e.start,e.expressions),{inline:this.options.inline,selectableSuggestionClass:"coveo-omnibox-selectable",selectedSuggestionClass:"coveo-omnibox-selected",suggestionTimeout:this.options.omniboxTimeout});var t=$.$$(this.magicBox.element).find("input");t&&$.$$(t).setAttribute("aria-label",S.l("Search")),this.setupMagicBox()},t.prototype.setupMagicBox=function(){var e=this;this.magicBox.onmove=function(){e.isAutoSuggestion()&&(e.modifyEventTo=e.getOmniboxAnalyticsEventCause()),e.movedOnce=!0},this.magicBox.onfocus=function(){e.isAutoSuggestion()&&(e.skipAutoSuggest=!0)},this.magicBox.onSuggestions=function(t){E.Utils.isEmptyString(e.getText())&&(e.omniboxAnalytics.partialQueries=[]),e.movedOnce=!1,e.lastSuggestions=t,e.isAutoSuggestion()&&!e.skipAutoSuggest&&e.searchAsYouType()},this.options.enableSearchAsYouType&&$.$$(this.element).addClass("coveo-magicbox-search-as-you-type"),this.magicBox.onchange=function(){e.skipAutoSuggest=!1;var t=e.getText();void 0!=t&&""!=t?e.isAutoSuggestion()?e.movedOnce&&e.searchAsYouType(!0):e.options.enableSearchAsYouType&&e.searchAsYouType(!0):e.clear()},this.options.placeholder&&(this.magicBox.element.querySelector("input").placeholder=this.options.placeholder),this.magicBox.onsubmit=function(){return e.submit()},this.magicBox.onselect=function(t){var n=r.indexOf(e.lastSuggestions,t),i=r.compact(r.map(e.lastSuggestions,function(e){return e.text}));e.magicBox.clearSuggestion(),e.updateQueryState(),e.isAutoSuggestion()?e.isAutoSuggestion()&&e.movedOnce?e.handleAutoSuggestionWithKeyboard(n,i):e.isAutoSuggestion()&&!e.movedOnce&&e.handleAutoSuggestionsWithMouse(n,i):(e.usageAnalytics.cancelAllPendingEvents(),e.triggerNewQuery(!1,function(){e.usageAnalytics.logSearchEvent(e.getOmniboxAnalyticsEventCause(),e.buildCustomDataForPartialQueries(n,i))})),e.isAutoSuggestion()&&(e.omniboxAnalytics.partialQueries=[])},this.magicBox.onblur=function(){e.isAutoSuggestion()&&(e.setText(e.getQuery(!0)),e.usageAnalytics.sendAllPendingEvents())},this.magicBox.onclear=function(){e.updateQueryState(),(e.options.triggerQueryOnClear||e.options.enableSearchAsYouType)&&e.triggerNewQuery(!1,function(){e.usageAnalytics.logSearchEvent(w.analyticsActionCauseList.searchboxClear,{})})},this.magicBox.ontabpress=function(){e.handleTabPress()},this.magicBox.getSuggestions=function(){return e.handleSuggestions()}},t.prototype.handleAutoSuggestionWithKeyboard=function(e,t){var n=this;this.searchAsYouTypeTimeout?(this.usageAnalytics.cancelAllPendingEvents(),clearTimeout(this.searchAsYouTypeTimeout),this.searchAsYouTypeTimeout=void 0,this.triggerNewQuery(!1,function(){n.usageAnalytics.logSearchEvent(n.getOmniboxAnalyticsEventCause(),n.buildCustomDataForPartialQueries(e,t))})):(this.modifyEventTo=this.getOmniboxAnalyticsEventCause(),this.modifyCustomDataOnPending(e,t),this.modifyQueryContentOnPending(),this.usageAnalytics.sendAllPendingEvents())},t.prototype.handleAutoSuggestionsWithMouse=function(e,t){var n=this;this.searchAsYouTypeTimeout||0!=e?(this.clearSearchAsYouType(),this.usageAnalytics.cancelAllPendingEvents(),this.triggerNewQuery(!1,function(){n.usageAnalytics.logSearchEvent(n.getOmniboxAnalyticsEventCause(),n.buildCustomDataForPartialQueries(e,t))})):(this.modifyEventTo=this.getOmniboxAnalyticsEventCause(),this.modifyCustomDataOnPending(e,t),this.modifyQueryContentOnPending(),this.usageAnalytics.sendAllPendingEvents(),this.lastQuery!=this.getText()&&this.triggerNewQuery(!1,function(){n.usageAnalytics.logSearchEvent(n.getOmniboxAnalyticsEventCause(),n.buildCustomDataForPartialQueries(e,t))}))},t.prototype.modifyCustomDataOnPending=function(e,t){var n=this.usageAnalytics.getPendingSearchEvent();if(n instanceof C.PendingSearchAsYouTypeSearchEvent){var i=this.buildCustomDataForPartialQueries(e,t);r.each(r.keys(i),function(e){n.modifyCustomData(e,i[e])})}},t.prototype.modifyQueryContentOnPending=function(){var e=this.usageAnalytics.getPendingSearchEvent();if(e instanceof C.PendingSearchAsYouTypeSearchEvent){var t=this.getQuery(this.options.enableSearchAsYouType);e.modifyQueryContent(t)}},t.prototype.buildCustomDataForPartialQueries=function(e,t){return this.updateOmniboxAnalytics(t,e),this.omniboxAnalytics.buildCustomDataForPartialQueries()},t.prototype.handleQuerySuggestGetFocus=function(e){var t=e.suggestion,n=r.compact(r.map(this.lastSuggestions,function(e){return e.text})),i=this.lastSuggestions.indexOf(u.findWhere(this.lastSuggestions,{text:t}));this.updateOmniboxAnalytics(n,i)},t.prototype.updateOmniboxAnalytics=function(e,t){this.omniboxAnalytics.suggestions=e,this.omniboxAnalytics.suggestionRanking=t},t.prototype.handleSuggestions=function(){var e=this.getText();if(!(this.options.querySuggestCharacterThreshold<=e.length))return[];var t={suggestions:[],omnibox:this};return this.triggerOmniboxSuggestions(t),E.Utils.isNullOrEmptyString(e)||this.omniboxAnalytics.partialQueries.push(e),r.compact(t.suggestions)},t.prototype.triggerOmniboxSuggestions=function(e){this.bind.trigger(this.element,l.OmniboxEvents.populateOmniboxSuggestions,e),$.$$(this.element).isDescendant(this.root)||this.bind.trigger(this.root,l.OmniboxEvents.populateOmniboxSuggestions,e)},t.prototype.handleBeforeRedirect=function(){this.updateQueryState()},t.prototype.handleBuildingQuery=function(e){var t=this;m.Assert.exists(e),m.Assert.exists(e.queryBuilder),this.updateQueryState(),this.lastQuery=this.getQuery(e.searchAsYouType);var n={result:this.lastQuery==this.magicBox.getDisplayedResult().input?this.magicBox.getDisplayedResult().clone():this.magicBox.grammar.parse(this.lastQuery).clean()};if(this.options.enableQuerySyntax){var i=n.result.findAll("FieldValueNotQuoted");if(r.each(i,function(e){return e.value='"'+e.value.replace(/"|\u00A0/g," ")+'"'}),this.options.fieldAlias){var s=n.result.findAll(function(e){return"FieldName"==e.expression.id&&e.isSuccess()});r.each(s,function(e){var n=r.find(r.keys(t.options.fieldAlias),function(t){return t.toLowerCase()==e.value.toLowerCase()});null!=n&&(e.value=t.options.fieldAlias[n])})}}this.triggerOmniboxPreprocessResultForQuery(n);var o=n.result.toString();new T.QueryboxQueryParameters(this.options).addParameters(e.queryBuilder,o)},t.prototype.triggerOmniboxPreprocessResultForQuery=function(e){this.bind.trigger(this.element,l.OmniboxEvents.omniboxPreprocessResultForQuery,e),$.$$(this.element).isDescendant(this.root)||this.bind.trigger(this.root,l.OmniboxEvents.omniboxPreprocessResultForQuery,e)},t.prototype.handleNewQuery=function(e){m.Assert.exists(e),this.options.clearFiltersOnNewQuery&&this.clearFiltersIfNewQuery(e)},t.prototype.clearFiltersIfNewQuery=function(e){var n,i=e.origin,s=e.searchAsYouType;if(!this.queryController.firstQuery){var o=[t.ID,"SearchButton"];if(i&&-1!==o.indexOf(i.type)){(this.queryController.getLastQuery().q||"")!==this.getQuery(s)&&this.bind.trigger(this.root,a.BreadcrumbEvents.clearBreadcrumb)}}},t.prototype.handleTabPress=function(){this.options.enableQuerySuggestAddon&&this.handleTabPressForSuggestions(),this.handleTabPressForOldOmniboxAddon()},t.prototype.handleTabPressForSuggestions=function(){if(this.options.enableSearchAsYouType)this.setText(this.getQuery(!0));else{var e=r.compact(r.map(this.lastSuggestions,function(e){return e.text}));this.usageAnalytics.logCustomEvent(this.getOmniboxAnalyticsEventCause(),this.buildCustomDataForPartialQueries(0,e),this.element)}},t.prototype.handleTabPressForOldOmniboxAddon=function(){var e=this.lastSuggestions.filter(function(e){return e.dom}).map(function(e){return $.$$(e.dom)}),t=this.findAllElementsWithClass(e,".coveo-omnibox-selected");if(t.length>0)$.$$(t[0]).trigger("tabSelect");else if(!this.options.enableQuerySuggestAddon){var n=this.findAllElementsWithClass(e,".coveo-omnibox-selectable");n.length>0&&$.$$(n[0]).trigger("tabSelect")}},t.prototype.findAllElementsWithClass=function(e,t){return e.map(function(e){return e.find(t)}).filter(function(e){return e}).reduce(function(e,t){return e.concat(t)},[])},t.prototype.triggerNewQuery=function(e,t){clearTimeout(this.searchAsYouTypeTimeout);var n=this.shouldExecuteQuery(e);this.lastQuery=this.getQuery(e),n&&t(),this.queryController.executeQuery({searchAsYouType:e,logInActionsHistory:!0,cancel:!n,origin:this})},t.prototype.getQuery=function(e){if(this.lastQuery==this.magicBox.getText())return this.lastQuery;if(!e)return this.magicBox.getText();var t=this.magicBox.getWordCompletion();if(null!=t)return t;var n=this.magicBox.getWordCompletion()||this.getFirstSuggestion();return n||this.isAutoSuggestion()&&this.lastQuery||this.magicBox.getText()},t.prototype.getFirstSuggestion=function(){if(null==this.lastSuggestions||this.lastSuggestions.length<=0)return"";var e=r.find(this.lastSuggestions,function(e){return null!=e.text});return null==e?"":e.text},t.prototype.updateQueryState=function(){this.queryStateModel.set(v.QueryStateModel.attributesEnum.q,this.magicBox.getText())},t.prototype.handleQueryStateChanged=function(e){m.Assert.exists(e);var t=e.value;t!=this.magicBox.getText()&&this.magicBox.setText(t)},t.prototype.handleQuerySuccess=function(){this.isAutoSuggestion()||(this.omniboxAnalytics.partialQueries=[])},t.prototype.handleDuringQuery=function(e){var t=this;e.promise.then(function(){var n=t.usageAnalytics.getPendingSearchEvent();n instanceof C.PendingSearchAsYouTypeSearchEvent&&n.beforeResolve.then(function(n){e.promise.then(function(){t.modifyEventTo&&(n.modifyEventCause(t.modifyEventTo),t.modifyEventTo=null)})})})},t.prototype.searchAsYouType=function(e){var t=this;void 0===e&&(e=!1),this.clearSearchAsYouType(),this.shouldExecuteQuery(!0)&&(this.searchAsYouTypeTimeout=window.setTimeout(function(){if(t.suggestionShouldTriggerQuery()||e){var n=r.map(t.lastSuggestions,function(e){return e.text}),i=r.indexOf(n,t.magicBox.getWordCompletion());t.triggerNewQuery(!0,function(){t.usageAnalytics.logSearchAsYouType(w.analyticsActionCauseList.searchboxAsYouType,t.buildCustomDataForPartialQueries(i,n))}),t.clearSearchAsYouType()}},this.options.searchAsYouTypeDelay))},t.prototype.isAutoSuggestion=function(){return this.options.enableSearchAsYouType&&this.options.enableQuerySuggestAddon},t.prototype.shouldExecuteQuery=function(e){var t=this.getQuery(e);return!1===this.searchInterface.options.allowQueriesWithoutKeywords?this.lastQuery!=t&&E.Utils.isNonEmptyString(t):this.lastQuery!=t&&null!=t},t.prototype.suggestionShouldTriggerQuery=function(e){if(void 0===e&&(e=this.lastSuggestions),this.shouldExecuteQuery(!0)&&e&&e[0]){var t=e[0];if(t&&void 0!=t.executableConfidence)return t.executableConfidence>=.8;if(t.text&&0==t.text.indexOf(this.magicBox.getText()))return!0}return!1},t.prototype.clearSearchAsYouType=function(){clearTimeout(this.searchAsYouTypeTimeout),this.searchAsYouTypeTimeout=void 0},t.prototype.getOmniboxAnalyticsEventCause=function(){return this.searchInterface instanceof B.StandaloneSearchInterface?w.analyticsActionCauseList.omniboxFromLink:w.analyticsActionCauseList.omniboxAnalytics},t.ID="Omnibox",t.doExport=function(){h.exportGlobally({Omnibox:t,QueryboxQueryParameters:T.QueryboxQueryParameters})},t.options={inline:Q.ComponentOptions.buildBooleanOption({defaultValue:!1}),enableSearchAsYouType:Q.ComponentOptions.buildBooleanOption({defaultValue:!1,section:"Advanced Options"}),searchAsYouTypeDelay:Q.ComponentOptions.buildNumberOption({defaultValue:2e3,min:0,depend:"enableSearchAsYouType",section:"Advanced Options"}),enableFieldAddon:Q.ComponentOptions.buildBooleanOption({defaultValue:!1,depend:"enableQuerySyntax",postProcessing:function(e,t){return e&&(t.enableQuerySyntax=!0),e},section:"Advanced Options"}),enableSimpleFieldAddon:Q.ComponentOptions.buildBooleanOption({defaultValue:!1,depend:"enableFieldAddon"}),listOfFields:Q.ComponentOptions.buildFieldsOption({depend:"enableFieldAddon"}),enableQuerySuggestAddon:Q.ComponentOptions.buildBooleanOption({defaultValue:!0,alias:["enableTopQueryAddon","enableRevealQuerySuggestAddon"]}),enableQueryExtensionAddon:Q.ComponentOptions.buildBooleanOption({defaultValue:!1,depend:"enableQuerySyntax",postProcessing:function(e,t){return e&&(t.enableQuerySyntax=!0),e},section:"Advanced Options"}),placeholder:Q.ComponentOptions.buildLocalizedStringOption(),omniboxTimeout:Q.ComponentOptions.buildNumberOption({defaultValue:2e3,min:0}),enableQuerySyntax:Q.ComponentOptions.buildBooleanOption({defaultValue:!1,section:"Advanced Options"}),numberOfSuggestions:Q.ComponentOptions.buildNumberOption({defaultValue:5,min:1}),querySuggestCharacterThreshold:Q.ComponentOptions.buildNumberOption({defaultValue:0,min:0}),clearFiltersOnNewQuery:Q.ComponentOptions.buildBooleanOption({defaultValue:!1})},t}(O.Component);t.Omnibox=I,I.options=o({},I.options,R.Querybox.options),_.Initialization.registerAutoCreateComponent(I)},194:function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),r=n(6),u=n(15),a=n(1),l=n(16),c=n(12),p=n(4),h=n(10),g=n(7),d=n(2),f=n(13),y=function(e){function t(n,i,s){var o=e.call(this,n,t.ID,s)||this;if(o.element=n,o.options=i,new u.AccessibleButton().withElement(n).withOwner(o.bind).withLabel(r.l("Search")).withSelectAction(function(){return o.handleClick()}).build(),""==p.Utils.trim(a.$$(o.element).text())){var h=a.$$("span",{className:"coveo-search-button"},c.SVGIcons.icons.search).el;l.SVGDom.addClassToSVGInContainer(h,"coveo-search-button-svg");var g=a.$$("span",{className:"coveo-search-button-loading"},c.SVGIcons.icons.loading).el;l.SVGDom.addClassToSVGInContainer(g,"coveo-search-button-loading-svg"),n.appendChild(h),n.appendChild(g)}return o}return s(t,e),t.prototype.click=function(){this.handleClick()},t.prototype.handleClick=function(){this.logger.debug("Performing query following button click"),this.updateQueryStateModelWithSearchboxQuery(),this.usageAnalytics.logSearchEvent(h.analyticsActionCauseList.searchboxSubmit,{}),this.queryController.executeQuery({origin:this,logInActionsHistory:!0})},t.prototype.updateQueryStateModelWithSearchboxQuery=function(){var e=this.options&&this.options.searchbox;e&&this.queryStateModel.set(f.QueryStateModel.attributesEnum.q,e.getText())},t.ID="SearchButton",t.doExport=function(){o.exportGlobally({SearchButton:t})},t.options={},t}(g.Component);t.SearchButton=y,d.Initialization.registerAutoCreateComponent(y)},217:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExpressionEndOfInput={id:"end of input",parse:null}},218:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(52),s=n(52),o=function(){function e(e,t){this.value=e,this.id=t}return e.prototype.parse=function(e,t){var n=0==e.indexOf(this.value),o=new i.Result(n?this.value:null,this,e);return n&&t&&e.length>this.value.length?new s.EndOfInputResult(o):o},e.prototype.toString=function(){return this.value},e}();t.ExpressionConstant=o},219:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(132),s=n(499);t.Field={basicExpressions:["FieldSimpleQuery","FieldQuery","Field"],grammars:{FieldQuery:"[Field][OptionalSpaces][FieldQueryOperation]",FieldQueryOperation:["FieldQueryValue","FieldQueryNumeric"],FieldQueryValue:"[FieldOperator][OptionalSpaces][FieldValue]",FieldQueryNumeric:"[FieldOperatorNumeric][OptionalSpaces][FieldValueNumeric]",FieldSimpleQuery:"[FieldName]:[OptionalSpaces][FieldValue]",Field:"@[FieldName]",FieldName:/[a-zA-Z][a-zA-Z0-9\.\_]*/,FieldOperator:/==|=|<>/,FieldOperatorNumeric:/<=|>=|<|>/,FieldValue:["DateRange","NumberRange","DateRelative","Date","Number","FieldValueList","FieldValueString"],FieldValueNumeric:["DateRelative","Date","Number"],FieldValueString:["DoubleQuoted","FieldValueNotQuoted"],FieldValueList:"([FieldValueString][FieldValueStringList*])",FieldValueStringList:"[FieldValueSeparator][FieldValueString]",FieldValueSeparator:/ *, */,FieldValueNotQuoted:/[^ \(\)\[\],]+/,NumberRange:"[Number][Spaces?]..[Spaces?][Number]"},include:[s.Date,i.Basic]}},220:function(e,t,n){"use strict";var i,s=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(s,o){function r(e){try{a(i.next(e))}catch(t){o(t)}}function u(e){try{a(i.throw(e))}catch(t){o(t)}}function a(e){e.done?s(e.value):new n(function(t){t(e.value)}).then(r,u)}a((i=i.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,i,s,o,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function o(u){if(n)throw TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=i[2&u[0]?"return":u[0]?"throw":"next"])&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[0,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(!(s=(s=r.trys).length>0&&s[s.length-1])&&(6===u[0]||2===u[0])){r=0;continue}if(3===u[0]&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(6===u[0]&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(a){u=[6,a],i=0}finally{n=s=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var r,u=n(0),a=n(34),l=n(7),c=n(1),p=n(563),h=n(503),g=n(21);(r=i=t.Direction||(t.Direction={})).Up="Up",r.Down="Down",r.Left="Left",r.Right="Right";var d=function(){function e(e,t,n,i){var s=this;this.element=e,this.magicBoxContainer=t,this.inputManager=n,this.suggestionListboxID="coveo-magicbox-suggestions-"+g.QueryUtils.createGuid(),this.suggestionListboxClassName="coveo-magicbox-suggestions",this.root=l.Component.resolveRoot(e),this.options=u.defaults(i,{suggestionClass:"magic-box-suggestion",selectedClass:"magic-box-selected"}),void 0==this.options.timeout&&(this.options.timeout=500),c.$$(this.element).on("mouseover",function(e){s.handleMouseOver(e)}),c.$$(this.element).on("mouseout",function(e){s.handleMouseOut(e)}),this.suggestionsProcessor=new h.QueryProcessor({timeout:this.options.timeout}),this.resultPreviewsManager=new p.ResultPreviewsManager(e,{selectedClass:this.options.selectedClass,timeout:this.options.timeout}),this.suggestionsListbox=this.buildSuggestionsContainer(),c.$$(this.element).append(this.suggestionsListbox.el),this.addAccessibilityProperties(),this.appendEmptySuggestionOption()}return Object.defineProperty(e.prototype,"hasSuggestions",{get:function(){return this.currentSuggestions&&this.currentSuggestions.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasFocus",{get:function(){return c.$$(this.element).findClass(this.options.selectedClass).length>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasPreviews",{get:function(){return this.resultPreviewsManager.hasPreviews},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"focusedSuggestion",{get:function(){var e=this;return u.find(this.currentSuggestions,function(t){return c.$$(t.dom).hasClass(e.options.selectedClass)||c.$$(t.dom).findClass(e.options.selectedClass).length>0})},enumerable:!0,configurable:!0}),e.prototype.handleMouseOver=function(e){var t=c.$$(e.target),n=t.parents(this.options.suggestionClass);t.hasClass(this.options.suggestionClass)?this.processMouseSelection(t.el):n.length>0&&this.element.contains(n[0])&&this.processMouseSelection(n[0])},e.prototype.handleMouseOut=function(e){var t=c.$$(e.target),n=t.parents(this.options.suggestionClass);if(e.relatedTarget&&c.$$(e.relatedTarget).isValid()){var i=c.$$(e.relatedTarget).parents(this.options.suggestionClass);t.hasClass(this.options.selectedClass)&&!c.$$(e.relatedTarget).hasClass(this.options.suggestionClass)?this.removeSelectedStatus(t.el):0==i.length&&n.length>0&&this.removeSelectedStatus(n[0])}else t.hasClass(this.options.selectedClass)?this.removeSelectedStatus(t.el):n.length>0&&this.removeSelectedStatus(n[0]);c.$$(this.root).trigger(a.OmniboxEvents.querySuggestLoseFocus)},e.prototype.moveDown=function(){return s(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.move(i.Down)];case 1:return e.sent(),[2]}})})},e.prototype.moveUp=function(){return s(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.move(i.Up)];case 1:return e.sent(),[2]}})})},e.prototype.moveLeft=function(){return s(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.move(i.Left)];case 1:return e.sent(),[2]}})})},e.prototype.moveRight=function(){return s(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.move(i.Right)];case 1:return e.sent(),[2]}})})},e.prototype.selectAndReturnKeyboardFocusedElement=function(){var e=this.keyboardFocusedElement;return e&&(c.$$(e).trigger("keyboardSelect"),this.keyboardFocusedElement=null,this.inputManager.blur()),e},e.prototype.clearKeyboardFocusedElement=function(){this.keyboardFocusedElement=null},e.prototype.receiveSuggestions=function(e){return s(this,void 0,void 0,function(){var t,n,i;return o(this,function(s){switch(s.label){case 0:return[4,this.suggestionsProcessor.processQueries(e)];case 1:if(n=(t=s.sent()).results,(i=t.status)===h.ProcessingStatus.Overriden)return[2,[]];return this.updateSuggestions(n),[2,n]}})})},e.prototype.clearSuggestions=function(){this.updateSuggestions([])},e.prototype.updateSuggestions=function(e){var t=this;if(this.suggestionsListbox.empty(),this.inputManager.activeDescendant=null,this.currentSuggestions=e,c.$$(this.element).toggleClass("magic-box-hasSuggestion",this.hasSuggestions),this.inputManager.expanded=this.hasSuggestions,this.resultPreviewsManager.displaySearchResultPreviewsForSuggestion(null),!this.hasSuggestions){this.appendEmptySuggestionOption(),c.$$(this.root).trigger(a.OmniboxEvents.querySuggestLoseFocus);return}e.sort(function(e,t){return(t.index||0)-(e.index||0)}).forEach(function(n){var i=n.dom?t.modifyDomFromExistingSuggestion(n.dom):t.createDomFromSuggestion(n);i.setAttribute("id","magic-box-suggestion-"+u.indexOf(e,n)),i.setAttribute("role","option"),i.setAttribute("aria-selected","false"),i.setAttribute("aria-label",i.text()),i.suggestion=n,t.suggestionsListbox.append(i.el)});var n=this.suggestionsListbox.findAll("."+this.options.suggestionClass).length;c.$$(this.root).trigger(a.OmniboxEvents.querySuggestRendered,{numberOfSuggestions:n})},Object.defineProperty(e.prototype,"selectedSuggestion",{get:function(){return this.htmlElementIsSuggestion(this.keyboardFocusedElement)?this.returnMoved(this.keyboardFocusedElement):null},enumerable:!0,configurable:!0}),e.prototype.processKeyboardSelection=function(e){return s(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return this.addSelectedStatus(e),this.keyboardFocusedElement=e,[4,this.updateSelectedSuggestion(this.focusedSuggestion)];case 1:return t.sent(),[2]}})})},e.prototype.processKeyboardPreviewSelection=function(e){this.addSelectedStatus(e),this.keyboardFocusedElement=e},e.prototype.processMouseSelection=function(e){this.addSelectedStatus(e),this.updateSelectedSuggestion(this.focusedSuggestion),this.keyboardFocusedElement=null},e.prototype.buildSuggestionsContainer=function(){return c.$$("div",{className:this.suggestionListboxClassName,id:this.suggestionListboxID,role:"listbox",ariaLabel:"Search Suggestions"})},e.prototype.createDomFromSuggestion=function(e){var t=this,n=c.$$("div",{className:"magic-box-suggestion "+this.options.suggestionClass});if(e.dom=n.el,n.on("click",function(){t.selectSuggestion(e)}),n.on("keyboardSelect",function(){t.selectSuggestion(e)}),e.html)return n.el.innerHTML=e.html,n;if(e.text)return n.text(e.text),n;if(e.separator){n.addClass("magic-box-suggestion-seperator");var i=c.$$("div",{className:"magic-box-suggestion-seperator-label"},e.separator);n.append(i.el)}return n},e.prototype.selectSuggestion=function(e){e.onSelect(),c.$$(this.root).trigger(a.OmniboxEvents.querySuggestSelection,{suggestion:e.text})},e.prototype.appendEmptySuggestionOption=function(){this.suggestionsListbox.append(c.$$("div",{role:"option"}).el)},e.prototype.modifyDomFromExistingSuggestion=function(e){this.removeSelectedStatus(e);var t=e.classList.contains(this.options.suggestionClass)?e:c.$$(e).find("."+this.options.suggestionClass);return this.removeSelectedStatus(t),c.$$(e)},e.prototype.move=function(e){return s(this,void 0,void 0,function(){var t;return o(this,function(n){switch(n.label){case 0:if(!this.resultPreviewsManager.focusedPreviewElement)return[3,2];return[4,this.moveWithinPreview(e)];case 1:case 3:return n.sent(),[2];case 2:if((e===i.Right||e===i.Left)&&(t=this.resultPreviewsManager.previewElements[0]))return this.processKeyboardPreviewSelection(t),[2];return[4,this.moveWithinSuggestion(e)]}})})},e.prototype.moveWithinSuggestion=function(e){return s(this,void 0,void 0,function(){var t,n,s,r;return o(this,function(o){switch(o.label){case 0:return t=c.$$(this.element).find("."+this.options.selectedClass),n=c.$$(this.element).findAll("."+this.options.suggestionClass),s=u.indexOf(n,t),r=((r=e===i.Up?s-1:s+1)+n.length)%n.length,[4,this.selectQuerySuggest(n[r])];case 1:return o.sent(),[2]}})})},e.prototype.selectQuerySuggest=function(e){return s(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:if(!e)return[3,2];return[4,this.processKeyboardSelection(e)];case 1:return t.sent(),[3,3];case 2:this.keyboardFocusedElement=null,this.inputManager.input.removeAttribute("aria-activedescendant"),t.label=3;case 3:return[2,e]}})})},e.prototype.moveWithinPreview=function(e){return s(this,void 0,void 0,function(){var t;return o(this,function(n){switch(n.label){case 0:if(t=this.resultPreviewsManager.getElementInDirection(e))return[3,2];return[4,this.selectQuerySuggest(this.resultPreviewsManager.previewsOwner.dom)];case 1:return n.sent(),[2];case 2:return this.processKeyboardPreviewSelection(t),[2]}})})},e.prototype.returnMoved=function(e){if(e){if(e.suggestion)return e.suggestion;if(e["no-text-suggestion"])return null;if(e instanceof HTMLElement)return{text:c.$$(e).text()}}return null},e.prototype.addSelectedStatus=function(e){for(var t=this.element.getElementsByClassName(this.options.selectedClass),n=0;n<t.length;n++){var i=t.item(n);this.removeSelectedStatus(i)}c.$$(e).addClass(this.options.selectedClass),this.updateAreaSelectedIfDefined(e,"true")},e.prototype.updateSelectedSuggestion=function(e){return s(this,void 0,void 0,function(){return o(this,function(t){switch(t.label){case 0:return c.$$(this.root).trigger(a.OmniboxEvents.querySuggestGetFocus,{suggestion:e.text}),[4,this.resultPreviewsManager.displaySearchResultPreviewsForSuggestion(e)];case 1:return t.sent(),[2]}})})},e.prototype.removeSelectedStatus=function(e){c.$$(e).removeClass(this.options.selectedClass),this.updateAreaSelectedIfDefined(e,"false")},e.prototype.updateAreaSelectedIfDefined=function(e,t){c.$$(e).getAttribute("aria-selected")&&(this.inputManager.activeDescendant=e,c.$$(e).setAttribute("aria-selected",t))},e.prototype.addAccessibilityProperties=function(){this.addAccessibilityPropertiesForMagicBox(),this.addAccessibilityPropertiesForInput()},e.prototype.addAccessibilityPropertiesForMagicBox=function(){var e=c.$$(this.magicBoxContainer);e.setAttribute("role","search"),e.setAttribute("aria-haspopup","listbox")},e.prototype.addAccessibilityPropertiesForInput=function(){var e=c.$$(this.inputManager.input);this.inputManager.activeDescendant=null,this.inputManager.expanded=!1,e.setAttribute("aria-owns",this.suggestionListboxID),e.setAttribute("aria-controls",this.suggestionListboxID)},e.prototype.htmlElementIsSuggestion=function(e){var t=c.$$(this.element).findAll("."+this.options.suggestionClass);return u.indexOf(t,e)>-1},e}();t.SuggestionsManager=d},221:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(s,o){function r(e){try{a(i.next(e))}catch(t){o(t)}}function u(e){try{a(i.throw(e))}catch(t){o(t)}}function a(e){e.done?s(e.value):new n(function(t){t(e.value)}).then(r,u)}a((i=i.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var n,i,s,o,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function o(u){if(n)throw TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=i[2&u[0]?"return":u[0]?"throw":"next"])&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[0,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(!(s=(s=r.trys).length>0&&s[s.length-1])&&(6===u[0]||2===u[0])){r=0;continue}if(3===u[0]&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(6===u[0]&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(a){u=[6,a],i=0}finally{n=s=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(20),u=n(1),a=n(561),l=n(502),c=n(564),p=n(220),h=function(){function e(e,t,n){void 0===n&&(n={});var i=this;this.element=e,this.grammar=t,this.options=n,this.lastSuggestions=[],o.isUndefined(this.options.inline)&&(this.options.inline=!1),u.$$(e).addClass("magic-box"),this.options.inline&&u.$$(e).addClass("magic-box-inline"),this.result=this.grammar.parse(""),this.displayedResult=this.result.clean();var s=u.$$(e).find(".magic-box-input");s||((s=document.createElement("div")).className="magic-box-input",e.appendChild(s)),this.inputManager=new l.InputManager(s,function(e,t){t?(i.setText(e),i.onselect&&i.onselect(i.firstSuggestionWithText)):(i.setText(e),i.addSuggestions(),i.onchange&&i.onchange())},this),this.inputManager.ontabpress=function(){i.ontabpress&&i.ontabpress()};var r=this.inputManager.getValue();r&&(this.displayedResult.input=r),this.inputManager.setResult(this.displayedResult);var a=document.createElement("div");a.className="magic-box-suggestions",this.element.appendChild(a),this.suggestionsManager=new p.SuggestionsManager(a,this.element,this.inputManager,{suggestionClass:this.options.selectableSuggestionClass,selectedClass:this.options.selectedSuggestionClass,timeout:this.options.suggestionTimeout}),this.magicBoxClear=new c.MagicBoxClear(this),this.setupHandler()}return Object.defineProperty(e.prototype,"firstSuggestionWithText",{get:function(){return o.find(this.lastSuggestions,function(e){return e.text})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstSuggestionText",{get:function(){var e=this.firstSuggestionWithText;return e?e.text:""},enumerable:!0,configurable:!0}),e.prototype.getResult=function(){return this.result},e.prototype.getDisplayedResult=function(){return this.displayedResult},e.prototype.setText=function(e){u.$$(this.element).toggleClass("magic-box-notEmpty",e.length>0),this.magicBoxClear.toggleTabindexAndAriaHidden(e.length>0),this.result=this.grammar.parse(e),this.displayedResult=this.result.clean(),this.inputManager.setResult(this.displayedResult)},e.prototype.setCursor=function(e){this.inputManager.setCursor(e)},e.prototype.getCursor=function(){return this.inputManager.getCursor()},e.prototype.resultAtCursor=function(e){return this.displayedResult.resultAt(this.getCursor(),e)},e.prototype.setupHandler=function(){var e=this;this.inputManager.onblur=function(){u.$$(e.element).removeClass("magic-box-hasFocus"),e.onblur&&e.onblur(),e.options.inline||e.clearSuggestion()},this.inputManager.onfocus=function(){u.$$(e.element).addClass("magic-box-hasFocus"),e.addSuggestions(),e.onfocus&&e.onfocus()},this.inputManager.onkeydown=function(t){return!e.shouldMoveInSuggestions(t)&&(t===r.KEYBOARD.ENTER?(null==e.suggestionsManager.selectAndReturnKeyboardFocusedElement()&&e.onsubmit&&e.onsubmit(),!1):(t===r.KEYBOARD.ESCAPE?(e.clearSuggestion(),e.blur()):e.suggestionsManager.clearKeyboardFocusedElement(),!0))},this.inputManager.onchangecursor=function(){e.addSuggestions()},this.inputManager.onkeyup=function(t){if(e.onmove&&e.onmove(),!e.shouldMoveInSuggestions(t))return!0;switch(t){case r.KEYBOARD.UP_ARROW:e.suggestionsManager.moveUp();break;case r.KEYBOARD.DOWN_ARROW:e.suggestionsManager.moveDown();break;case r.KEYBOARD.LEFT_ARROW:e.suggestionsManager.moveLeft();break;case r.KEYBOARD.RIGHT_ARROW:e.suggestionsManager.moveRight()}return e.suggestionsManager.selectedSuggestion&&e.focusOnSuggestion(e.suggestionsManager.selectedSuggestion),e.onchange&&e.onchange(),!1}},e.prototype.addSuggestions=function(){return i(this,void 0,void 0,function(){var e;return s(this,function(t){switch(t.label){case 0:return[4,this.suggestionsManager.receiveSuggestions(null!=this.getSuggestions?this.getSuggestions():[])];case 1:return e=t.sent(),this.addSelectEventHandlers(e),this.inputManager.setWordCompletion(this.firstSuggestionText),this.onSuggestions(e),[2]}})})},e.prototype.shouldMoveInSuggestions=function(e){switch(e){case r.KEYBOARD.UP_ARROW:case r.KEYBOARD.DOWN_ARROW:return!0;case r.KEYBOARD.LEFT_ARROW:case r.KEYBOARD.RIGHT_ARROW:if(this.suggestionsManager.hasFocus&&this.suggestionsManager.hasPreviews)return!0}return!1},e.prototype.addSelectEventHandlers=function(e){var t=this;o.each(e,function(e){null==e.onSelect&&null!=e.text&&(e.onSelect=function(){t.setText(e.text),t.onselect&&t.onselect(e)})})},e.prototype.focus=function(){u.$$(this.element).addClass("magic-box-hasFocus"),this.inputManager.focus()},e.prototype.blur=function(){this.inputManager.blur()},e.prototype.clearSuggestion=function(){return i(this,void 0,void 0,function(){return s(this,function(e){return this.inputManager.setWordCompletion(null),this.suggestionsManager.clearSuggestions(),this.onSuggestions([]),[2]})})},e.prototype.focusOnSuggestion=function(e){null==e||null==e.text?this.inputManager.setResult(this.displayedResult,this.firstSuggestionText):this.inputManager.setResult(this.grammar.parse(e.text).clean(),e.text)},e.prototype.getText=function(){return this.inputManager.getValue()},e.prototype.getWordCompletion=function(){return this.inputManager.getWordCompletion()},e.prototype.clear=function(){this.setText(""),this.clearSuggestion(),this.focus(),this.onclear&&this.onclear()},e.prototype.hasSuggestions=function(){return this.suggestionsManager.hasSuggestions},e}();t.MagicBoxInstance=h,t.createMagicBox=function e(t,n,i){return new h(t,n,i)},t.requestAnimationFrame=function e(t){return"requestAnimationFrame"in window?window.requestAnimationFrame(t):setTimeout(t)},a.doMagicBoxExport()},222:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=function(){function e(){}return e.escapeRegExp=function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},e.highlightText=function(e,t,n,i,s){var o=this;if(void 0===n&&(n=!1),void 0===i&&(i="magic-box-hightlight"),void 0===s&&(s=""),0==t.length)return e;var r=this.escapeRegExp(t),u=RegExp("("+r+")|(.*?(?="+r+")|.+)",n?"gi":"g");return e.replace(u,function(e,t,n){return o.escapeText(null!=t?i:s,e)})},e.escapeText=function(e,t){return'<span class="'+e+'">'+i.escape(t)+"</span>"},e}();t.MagicBoxUtils=s},281:function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e};Object.defineProperty(t,"__esModule",{value:!0}),n(670);var r=n(3),u=n(1),a=n(16),l=n(12),c=n(671),p=n(7),h=n(8),g=n(2),d=n(192),f=n(138),y=n(194),m=n(0),b=function(e){function t(n,i,s){var o=e.call(this,n,t.ID,s)||this;return o.element=n,o.options=i,o.bindings=s,o.options=h.ComponentOptions.initComponentOptions(n,t,i),o.options.inline&&u.$$(n).addClass("coveo-inline"),o.initSearchButton(),o.initSearchBox(),o.applyMagicBoxIcon(),o.applyCustomHeight(),o}return s(t,e),t.prototype.initSearchBox=function(){var e=document.createElement("div");this.element.appendChild(e),this.options.enableOmnibox?this.searchbox=new d.Omnibox(e,this.options,this.bindings):this.searchbox=new f.Querybox(e,this.options,this.bindings)},t.prototype.initSearchButton=function(){if(this.options.addSearchButton){var e=u.$$("a");this.element.appendChild(e.el),this.searchButton=new y.SearchButton(e.el,{searchbox:this.searchbox},this.bindings)}},t.prototype.applyMagicBoxIcon=function(){var e=u.$$(this.element).find(".magic-box-icon");e.innerHTML=l.SVGIcons.icons.mainClear,a.SVGDom.addClassToSVGInContainer(e,"magic-box-clear-svg")},t.prototype.applyCustomHeight=function(){this.options.height&&(u.$$(this.element).addClass("coveo-custom-height"),c.SearchBoxResize.resize(this.element,this.options.height))},t.ID="Searchbox",t.parent=d.Omnibox,t.doExport=function(){r.exportGlobally({Searchbox:t,SearchButton:y.SearchButton,Omnibox:d.Omnibox,Querybox:f.Querybox})},t.options={addSearchButton:h.ComponentOptions.buildBooleanOption({defaultValue:!0}),height:h.ComponentOptions.buildNumberOption({min:25}),enableOmnibox:h.ComponentOptions.buildBooleanOption({defaultValue:!0})},t}(p.Component);t.Searchbox=b,b.options=o({},b.options,d.Omnibox.options,f.Querybox.options),m.each(b.options,function(e,t){t in d.Omnibox.options&&!(t in f.Querybox.options)&&(b.options[t]=m.extend({depend:"enableOmnibox"},e))}),g.Initialization.registerAutoCreateComponent(b)},491:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(52),s=n(492),o=n(217),r=n(0),u=function(){function e(e,t,n,i){this.ref=e,this.occurrence=t,this.id=n,this.grammar=i}return e.prototype.parse=function(e,t){var n=this.grammar.getExpression(this.ref);if(null==n)throw Error("Expression not found:"+this.ref);return"?"==this.occurrence||null==this.occurrence?this.parseOnce(e,t,n):this.parseMany(e,t,n)},e.prototype.parseOnce=function(e,t,n){var u=n.parse(e,t),a=u.isSuccess();if(!a&&"?"==this.occurrence)return t?0==e.length?new s.RefResult([],this,e,u):r.all(u.getBestExpect(),function(e){return e.expression==o.ExpressionEndOfInput})?new s.RefResult([new i.Result(null,o.ExpressionEndOfInput,e)],this,e,u):u:new s.RefResult([],this,e,null);return new s.RefResult([u],this,e,a?null:u)},e.prototype.parseMany=function(e,t,n){var u,a,l=[],c=e;do(a=(u=n.parse(c,!1)).isSuccess())&&(l.push(u),c=c.substr(u.getLength()));while(a&&u.input!=c);var p=r.isNumber(this.occurrence)?this.occurrence:"+"==this.occurrence?1:0;if(l.length<p)l.push(u);else if(t){if(l.length>0){var h=r.last(l);(u=n.parse(h.input,!0)).isSuccess()?l[l.length-1]=u:(l.push(new i.Result(null,o.ExpressionEndOfInput,h.input.substr(h.getLength()))),u=n.parse(h.input.substr(h.getLength()),!0))}else if(0!=e.length){var g=new i.Result(null,o.ExpressionEndOfInput,e);return new s.RefResult([g],this,e,u)}}return new s.RefResult(l,this,e,u)},e.prototype.toString=function(){return this.id},e}();t.ExpressionRef=u},492:function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(52),r=n(0),u=function(e){function t(t,n,i,s){var o=e.call(this,t,n,i)||this;return o.expression=n,o.input=i,r.last(t)!=s&&(o.failAttempt=s,null!=o.failAttempt&&(o.failAttempt.parent=o)),o}return s(t,e),t.prototype.getExpect=function(){var t=e.prototype.getExpect.call(this);return null!=this.failAttempt?t.concat(this.failAttempt.getExpect()):t},t.prototype.clean=function(t){if(null!=this.failAttempt&&(null!=t||!this.isSuccess())){t=t||r.last(this.getBestExpect()).path(this);var n=r.first(t);if(null!=n&&n==this.failAttempt){var i=r.last(this.subResults),s=r.map(null!=i&&i.isSuccess()?this.subResults:r.initial(this.subResults),function(e){return e.clean()});return s.push(n.clean(r.rest(t))),new o.Result(s,this.expression,this.input)}}return e.prototype.clean.call(this,t)},t}(o.Result);t.RefResult=u},493:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(494),s=function(){function e(e,t){this.parts=e,this.id=t}return e.prototype.parse=function(e,t){for(var n=[],s=0;s<this.parts.length;s++){var o=this.parts[s].parse(e,t);if(o.isSuccess())return new i.OptionResult(o,this,e,n);n.push(o)}return new i.OptionResult(null,this,e,n)},e.prototype.toString=function(){return this.id},e}();t.ExpressionOptions=s},494:function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(52),r=n(0),u=function(e){function t(t,n,i,s){var o=e.call(this,null!=t?[t]:null,n,i)||this;return o.result=t,o.expression=n,o.input=i,o.failAttempt=s,r.forEach(o.failAttempt,function(e){e.parent=o}),o}return s(t,e),t.prototype.getExpect=function(){var e=this,t=[];return(null!=this.result&&(t=this.result.getExpect()),(t=r.reduce(this.failAttempt,function(e,t){return e.concat(t.getExpect())},t)).length>0&&r.all(t,function(t){return t.input==e.input}))?[this]:t},t.prototype.clean=function(e){if(null!=e||!this.isSuccess()){e=r.rest(e||r.last(this.getBestExpect()).path(this));var t=r.first(e);return null==t?new o.Result(null,this.expression,this.input):new o.Result([t.clean(r.rest(e))],this.expression,this.input)}return new o.Result(r.map(this.result.subResults,function(e){return e.clean()}),this.expression,this.input)},t}(o.Result);t.OptionResult=u},495:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(52),s=n(52),o=function(){function e(e,t,n){this.value=e,this.id=t}return e.prototype.parse=function(e,t){var n=e.match(this.value);null!=n&&0!=n.index&&(n=null);var o=new i.Result(null!=n?n[0]:null,this,e);return o.isSuccess()&&t&&e.length>o.value.length?new s.EndOfInputResult(o):o},e.prototype.toString=function(){return this.id},e}();t.ExpressionRegExp=o},496:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,n){this.func=e,this.id=t,this.grammar=n}return e.prototype.parse=function(e,t){return this.func(e,t,this)},e.prototype.toString=function(){return this.id},e}();t.ExpressionFunction=i},497:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(52),s=function(){function e(e,t){if(this.parts=e,this.id=t,0==e.length)throw Error(JSON.stringify(t)+" should have at least 1 parts")}return e.prototype.parse=function(e,t){for(var n,s=[],o=e,r=0;r<this.parts.length;r++)if(n=this.parts[r].parse(o,t&&r==this.parts.length-1),s.push(n),n.isSuccess())o=o.substr(n.getLength());else break;return new i.Result(s,this,e)},e.prototype.toString=function(){return this.id},e}();t.ExpressionList=s},498:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(219);t.NestedQuery={basicExpressions:["NestedQuery"],grammars:{NestedQuery:"[[NestedField][OptionalSpaces][Expressions]]",NestedField:"[[Field]]",FieldValue:["NestedQuery"]},include:[i.Field]}},499:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(132);t.Date={grammars:{Date:"[DateYear]/[DateMonth]/[DateDay]",DateYear:/([0-9]{4})/,DateMonth:/(1[0-2]|0?[1-9])/,DateDay:/([1-2][0-9]|3[0-1]|0?[1-9])/,DateRange:"[Date][Spaces?]..[Spaces?][Date]",DateRelative:["DateRelativeNegative","DateRelativeTerm"],DateRelativeTerm:/now|today|yesterday/,DateRelativeNegative:"[DateRelativeTerm][DateRelativeNegativeRef]",DateRelativeNegativeRef:/([\-\+][0-9]+(s|m|h|d|mo|y))/},include:[i.Basic]}},500:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(132);t.QueryExtension={basicExpressions:["QueryExtension"],grammars:{QueryExtension:"$[QueryExtensionName]([QueryExtensionArguments])",QueryExtensionName:/\w+/,QueryExtensionArguments:"[QueryExtensionArgumentList*][QueryExtensionArgument]",QueryExtensionArgumentList:"[QueryExtensionArgument][Spaces?],[Spaces?]",QueryExtensionArgument:"[QueryExtensionArgumentName]:[Spaces?][QueryExtensionArgumentValue]",QueryExtensionArgumentName:/\w+/,QueryExtensionArgumentValue:["SingleQuoted","Expressions"]},include:[i.Basic]}},501:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubExpression={basicExpressions:["SubExpression"],grammars:{SubExpression:"([Expressions])"}}},502:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=n(20),o=n(6),r=n(1),u=n(25),a=function(){function e(e,t,n){this.onchange=t,this.magicBox=n,this.hasFocus=!1,this.root=s.Component.resolveRoot(e),this.underlay=document.createElement("div"),this.underlay.className="magic-box-underlay",this.highlightContainer=document.createElement("span"),this.highlightContainer.className="magic-box-highlight-container",this.underlay.appendChild(this.highlightContainer),this.ghostTextContainer=document.createElement("span"),this.ghostTextContainer.className="magic-box-ghost-text",this.underlay.appendChild(this.ghostTextContainer),this.input=r.$$(e).find("input"),this.input?e.insertBefore(this.underlay,this.input):(this.input=document.createElement("input"),e.appendChild(this.underlay),e.appendChild(this.input)),this.setupHandler(),this.addAccessibilitiesProperties()}return Object.defineProperty(e.prototype,"expanded",{set:function(e){this.input.setAttribute("aria-expanded",e.toString())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeDescendant",{set:function(e){e?this.input.setAttribute("aria-activedescendant",e.id):this.input.removeAttribute("aria-activedescendant")},enumerable:!0,configurable:!0}),e.prototype.updateInput=function(){this.input.value!=this.result.input&&(this.input.value=this.result.input,this.hasFocus&&this.setCursor(this.getValue().length))},e.prototype.updateHighlight=function(){r.$$(this.highlightContainer).empty(),this.highlightContainer.appendChild(this.result.toHtmlElement())},e.prototype.updateWordCompletion=function(){r.$$(this.ghostTextContainer).empty(),this.ghostTextContainer.innerHTML="",null!=this.wordCompletion&&this.ghostTextContainer.appendChild(document.createTextNode(this.wordCompletion.substr(this.result.input.length)))},e.prototype.setResult=function(e,t){this.result=e,this.updateInput(),this.updateHighlight(),i.isUndefined(t)&&null!=this.wordCompletion&&0==this.wordCompletion.indexOf(this.result.input)?this.updateWordCompletion():this.setWordCompletion(t),this.updateScroll()},e.prototype.setWordCompletion=function(e){null!=e&&0!=e.toLowerCase().indexOf(this.result.input.toLowerCase())&&(e=null),this.wordCompletion=e,this.updateWordCompletion(),this.updateScroll()},e.prototype.setCursor=function(e){if(this.input.focus(),this.input.createTextRange){var t=this.input.createTextRange();t.move("character",e),t.select()}else null!=this.input.selectionStart&&(this.input.focus(),this.input.setSelectionRange(e,e))},e.prototype.getCursor=function(){return this.input.selectionStart},e.prototype.updateScroll=function(e){var t=this;void 0===e&&(e=!0);var n=function(){t.underlay.clientWidth<t.underlay.scrollWidth&&(t.underlay.style.visibility="hidden",t.underlay.scrollLeft=t.input.scrollLeft,t.underlay.scrollTop=t.input.scrollTop,t.underlay.style.visibility="visible"),t.updateScrollDefer=null,t.hasFocus&&t.updateScroll()};e?null==this.updateScrollDefer&&(this.updateScrollDefer=requestAnimationFrame(n)):n()},e.prototype.setupHandler=function(){var e=this;this.input.onblur=function(){e.hasFocus=!1,setTimeout(function(){!e.hasFocus&&e.onblur&&e.onblur()},300),e.updateScroll()},this.input.onfocus=function(){!e.hasFocus&&(e.hasFocus=!0,e.updateScroll(),e.onfocus&&e.onfocus())},this.input.onkeydown=function(t){e.keydown(t)},this.input.onkeyup=function(t){e.keyup(t)},this.input.oncut=function(){setTimeout(function(){e.onInputChange()})},this.input.onpaste=function(){setTimeout(function(){e.onInputChange()})}},e.prototype.addAccessibilitiesProperties=function(){this.input.setAttribute("autocomplete","off"),this.input.setAttribute("type","text"),this.input.setAttribute("role","combobox"),this.input.setAttribute("form","coveo-dummy-form"),this.input.setAttribute("aria-autocomplete","list"),this.input.setAttribute("title",o.l("InsertAQuery")+". "+o.l("PressEnterToSend"))},e.prototype.focus=function(){var e=this;setTimeout(function(){e.input.focus(),e.setCursor(e.getValue().length)})},e.prototype.blur=function(){this.hasFocus&&this.input.blur()},e.prototype.keydown=function(e){var t=this;(e.keyCode||e.which)===u.KEYBOARD.TAB?(this.tabPress(),this.magicBox.clearSuggestion()):(e.stopPropagation(),null==this.onkeydown||this.onkeydown(e.keyCode||e.which)?requestAnimationFrame(function(){t.onInputChange()}):e.preventDefault())},e.prototype.keyup=function(e){switch(e.keyCode||e.which){case u.KEYBOARD.LEFT_ARROW:case u.KEYBOARD.RIGHT_ARROW:this.handleLeftRightArrow(e);break;default:null==this.onkeydown||this.onkeyup(e.keyCode||e.which)?this.onInputChange():e.preventDefault()}},e.prototype.handleLeftRightArrow=function(e){r.$$(this.root).find("."+s.Component.computeCssClassNameForType("QuerySuggestPreview"))||this.onchangecursor(),null==this.onkeydown||this.onkeyup(e.keyCode||e.which)?this.onInputChange():e.preventDefault()},e.prototype.tabPress=function(){this.ontabpress&&this.ontabpress(),this.onblur&&this.onblur()},e.prototype.onInputChange=function(){this.result.input!=this.input.value&&this.onchange(this.input.value,!1)},e.prototype.getValue=function(){return this.input.value},e.prototype.getWordCompletion=function(){return this.wordCompletion},e}();t.InputManager=a},503:function(e,t,n){"use strict";var i,s=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},o=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(s,o){function r(e){try{a(i.next(e))}catch(t){o(t)}}function u(e){try{a(i.throw(e))}catch(t){o(t)}}function a(e){e.done?s(e.value):new n(function(t){t(e.value)}).then(r,u)}a((i=i.apply(e,t||[])).next())})},r=this&&this.__generator||function(e,t){var n,i,s,o,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function o(u){if(n)throw TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=i[2&u[0]?"return":u[0]?"throw":"next"])&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[0,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(!(s=(s=r.trys).length>0&&s[s.length-1])&&(6===u[0]||2===u[0])){r=0;continue}if(3===u[0]&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(6===u[0]&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(a){u=[6,a],i=0}finally{n=s=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var u,a=n(0);(u=i=t.ProcessingStatus||(t.ProcessingStatus={}))[u.Finished=0]="Finished",u[u.TimedOut=1]="TimedOut",u[u.Overriden=2]="Overriden";var l=function(){function e(e){void 0===e&&(e={}),this.options=s({timeout:500},e)}return e.prototype.processQueries=function(e){return o(this,void 0,void 0,function(){var t,n=this;return r(this,function(s){var o;return this.overrideIfProcessing(),this.processedResults=Array(e.length),t=e.map(function(e){return e instanceof Promise?e:Promise.resolve(e)}),[2,(o=[this.accumulateResultsChronologically(t).then(function(){return n.buildProcessResults(i.Finished)}),this.waitForOverride().then(function(){return n.buildProcessResults(i.Overriden)}),this.waitForTimeout().then(function(){return n.buildProcessResults(i.TimedOut)})],new Promise(function(e,t){return o.forEach(function(n){return Promise.resolve(n).then(e,t)})}))]})})},e.prototype.overrideIfProcessing=function(){return o(this,void 0,void 0,function(){return r(this,function(e){return this.override&&this.override(),[2]})})},Object.defineProperty(e.prototype,"orderedResults",{get:function(){return a.flatten(this.processedResults.filter(function(e){return!!e}),!0)},enumerable:!0,configurable:!0}),e.prototype.buildProcessResults=function(e){return{status:e,results:e!==i.Overriden?this.orderedResults:[]}},e.prototype.accumulateResultsChronologically=function(e){return o(this,void 0,void 0,function(){var t;return r(this,function(n){switch(n.label){case 0:return t=this.processedResults,[4,Promise.all(e.map(function(e,n){return e.then(function(e){return t[n]=e})}))];case 1:return n.sent(),[2]}})})},e.prototype.waitForOverride=function(){var e=this;return new Promise(function(t){e.override=function(){e.override=null,t()}})},e.prototype.waitForTimeout=function(){var e=this;return new Promise(function(t){return setTimeout(function(){return t()},e.options.timeout)})},e}();t.QueryProcessor=l},506:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(498),s=n(500),o=n(132),r=n(219),u=n(501);t.Complete={include:[i.NestedQuery,s.QueryExtension,u.SubExpression,r.Field,o.Basic]}},507:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(175),s=n(0);function o(e,t,n,i){s.each(i.expressions,function(t){s.contains(e,t)||e.push(t)}),s.each(i.basicExpressions,function(e){s.contains(t,e)||t.push(e)}),s.each(i.grammars,function(e,t){if(t in n){if(s.isArray(n[t])&&s.isArray(e))s.each(e,function(e){n[t].push(e)});else throw s.each(e,function(e){n[t].push(e)}),Error("Can not merge "+t+"("+JSON.stringify(e)+" => "+JSON.stringify(n[t])+")")}else n[t]=e})}function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],i=[],r={Start:["Expressions","Empty"],Expressions:"[OptionalSpaces][Expression][ExpressionsList*][OptionalSpaces]",ExpressionsList:"[Spaces][Expression]",Expression:n,BasicExpression:i,OptionalSpaces:/ */,Spaces:/ +/,Empty:/(?!.)/},u=0;u<e.length;u++)o(n,i,r,e[u]),s.each(e[u].include,function(t){s.contains(e,t)||e.push(t)});return n.push("BasicExpression"),{start:"Start",expressions:r}}t.Expressions=r,t.ExpressionsGrammar=function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var s=r.apply(this,t);return new i.Grammar(s.start,s.expressions)}},508:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.buildingResultPreviewsQuery="buildingResultPreviewsQuery",e.updateResultPreviewsManagerOptions="updateResultPreviewsManagerOptions",e.populateSearchResultPreviews="populateSearchResultPreviews",e}();t.ResultPreviewsManagerEvents=i},509:function(e,t,n){"use strict";var i=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e};Object.defineProperty(t,"__esModule",{value:!0});var s=n(28),o=function(){function e(e){this.owner=e}return Object.defineProperty(e.prototype,"options",{get:function(){return this.owner.options},set:function(e){this.owner.options=e},enumerable:!0,configurable:!0}),e.prototype.postProcess=function(){this.options=i({},this.options,this.owner.componentOptionsModel.get(s.ComponentOptionsModel.attributesEnum.searchBox)),this.processQueryOnClearVersusEmptyQuery(),this.processQueryOnClearVersusSearchAsYouType()},e.prototype.processQueryOnClearVersusEmptyQuery=function(){this.options.triggerQueryOnClear&&!1===this.owner.searchInterface.options.allowQueriesWithoutKeywords&&(this.owner.logger.warn('Forcing option triggerQueryOnClear to false, as it is not supported when the search interface is configured to not allow queries without keywords (data-allow-queries-without-keywords="false")',this.owner),this.options.triggerQueryOnClear=!1)},e.prototype.processQueryOnClearVersusSearchAsYouType=function(){!0===this.owner.searchInterface.options.allowQueriesWithoutKeywords&&!1===this.options.triggerQueryOnClear&&!0===this.options.enableSearchAsYouType&&(this.owner.logger.warn("Forcing option triggerQueryOnClear to true, since search-as-you-type is enabled",this.owner),this.options.triggerQueryOnClear=!0)},e}();t.QueryboxOptionsProcessing=o},510:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=n(74),o=function(){function e(e){this.options=e}return e.queryIsBlocked=function(){return!!e.queryIsCurrentlyBlocked||(e.queryIsCurrentlyBlocked=!0,s.Defer.defer(function(){return e.allowDuplicateQuery()}),!1)},e.allowDuplicateQuery=function(){e.queryIsCurrentlyBlocked=!1},e.prototype.addParameters=function(t,n){!e.queryIsBlocked()&&(this.options.enableWildcards&&(t.enableWildcards=!0),this.options.enableQuestionMarks&&(t.enableQuestionMarks=!0),this.options.enableLowercaseOperators&&(t.enableLowercaseOperators=!0),!i.isEmpty(n)&&(t.enableQuerySyntax=this.options.enableQuerySyntax,t.expression.add(n),this.options.enablePartialMatch&&(t.enablePartialMatch=this.options.enablePartialMatch,this.options.partialMatchKeywords&&(t.partialMatchKeywords=this.options.partialMatchKeywords),this.options.partialMatchThreshold&&(t.partialMatchThreshold=this.options.partialMatchThreshold))))},e.queryIsCurrentlyBlocked=!1,e}();t.QueryboxQueryParameters=o},52:function(e,t,n){"use strict";var i,s=this&&this.__extends||(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(217),r=n(218),u=n(0),a=function(){function e(e,t,n){var i=this;this.expression=t,this.input=n,u.isString(e)?this.value=e:u.isArray(e)&&(this.subResults=e,u.forEach(this.subResults,function(e){e.parent=i}))}return e.prototype.isSuccess=function(){return null!=this.value||null!=this.subResults&&u.all(this.subResults,function(e){return e.isSuccess()})},e.prototype.path=function(e){var t=null!=this.parent&&this.parent!=e?this.parent.path(e):[];return t.push(this),t},e.prototype.findParent=function(e){for(var t=this,n=u.isString(e)?function(t){return e==t.expression.id}:e;null!=t&&!n(t);)t=t.parent;return t},e.prototype.find=function(e){var t=u.isString(e)?function(t){return e==t.expression.id}:e;if(t(this))return this;if(this.subResults)for(var n=0;n<this.subResults.length;n++){var i=this.subResults[n].find(t);if(i)return i}return null},e.prototype.findAll=function(e){var t=[],n=u.isString(e)?function(t){return e==t.expression.id}:e;return n(this)&&t.push(this),this.subResults&&(t=u.reduce(this.subResults,function(e,t){return e.concat(t.findAll(n))},t)),t},e.prototype.resultAt=function(e,t){if(e<0||e>this.getLength())return[];if(null!=t){if(u.isString(t)){if(t==this.expression.id)return[this]}else if(t(this))return[this]}else if(null!=(null==this.value&&null==this.subResults?this.input:this.value))return[this];if(null!=this.subResults){for(var n=[],i=0;i<this.subResults.length;i++){var s=this.subResults[i];if(n=n.concat(s.resultAt(e,t)),(e-=s.getLength())<0)break}return n}return[]},e.prototype.getExpect=function(){return null==this.value&&null==this.subResults?[this]:null!=this.subResults?u.reduce(this.subResults,function(e,t){return e.concat(t.getExpect())},[]):[]},e.prototype.getBestExpect=function(){var e=this.getExpect(),t=u.groupBy(e,function(e){return e.input}),n=t[u.last(u.keys(t).sort(function(e,t){return t.length-e.length}))],t=u.groupBy(n,function(e){return e.expression.id});return u.map(t,function(e){return u.chain(e).map(function(e){return{path:e.path().length,result:e}}).sortBy("path").pluck("result").first().value()})},e.prototype.getHumanReadableExpect=function(){var e=this.getBestExpect(),t=e.length>0?u.last(e).input:"";return"Expected "+u.map(e,function(e){return e.getHumanReadable()}).join(" or ")+" but "+(t.length>0?JSON.stringify(t[0]):"end of input")+" found."},e.prototype.before=function(){if(null==this.parent)return"";var e=u.indexOf(this.parent.subResults,this);return this.parent.before()+u.chain(this.parent.subResults).first(e).map(function(e){return e.toString()}).join("").value()},e.prototype.after=function(){if(null==this.parent)return"";var e=u.indexOf(this.parent.subResults,this);return u.chain(this.parent.subResults).last(this.parent.subResults.length-e-1).map(function(e){return e.toString()}).join("").value()+this.parent.after()},e.prototype.getLength=function(){return null!=this.value?this.value.length:null!=this.subResults?u.reduce(this.subResults,function(e,t){return e+t.getLength()},0):this.input.length},e.prototype.toHtmlElement=function(){var e=document.createElement("span"),t=null!=this.expression?this.expression.id:null;return null!=t&&e.setAttribute("data-id",t),e.setAttribute("data-success",this.isSuccess().toString()),null!=this.value?(e.appendChild(document.createTextNode(this.value)),e.setAttribute("data-value",this.value)):null!=this.subResults?u.each(this.subResults,function(t){e.appendChild(t.toHtmlElement())}):(e.appendChild(document.createTextNode(this.input)),e.setAttribute("data-input",this.input),e.className="magic-box-error"+(this.input.length>0?"":" magic-box-error-empty")),e.result=this,e},e.prototype.clean=function(t){if(null!=t||!this.isSuccess()){t=t||u.last(this.getBestExpect()).path(this);var n=u.first(t);if(null==n)return new e(null,this.expression,this.input);var i=u.indexOf(this.subResults,n),s=-1==i?[]:u.map(u.first(this.subResults,i),function(e){return e.clean()});return s.push(n.clean(u.rest(t))),new e(s,this.expression,this.input)}return null!=this.value?new e(this.value,this.expression,this.input):null!=this.subResults?new e(u.map(this.subResults,function(e){return e.clean()}),this.expression,this.input):void 0},e.prototype.clone=function(){return null!=this.value?new e(this.value,this.expression,this.input):null!=this.subResults?new e(u.map(this.subResults,function(e){return e.clone()}),this.expression,this.input):new e(null,this.expression,this.input)},e.prototype.toString=function(){return null!=this.value?this.value:null!=this.subResults?u.map(this.subResults,function(e){return e.toString()}).join(""):this.input},e.prototype.getHumanReadable=function(){return this.expression instanceof r.ExpressionConstant?JSON.stringify(this.expression.value):this.expression.id},e}();t.Result=a;var l=function(e){function t(t){var n=e.call(this,[t],o.ExpressionEndOfInput,t.input)||this,i=new a(null,o.ExpressionEndOfInput,t.input.substr(t.getLength()));return i.parent=n,n.subResults.push(i),n}return s(t,e),t}(a);t.EndOfInputResult=l},561:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),s=n(218),o=n(217),r=n(496),u=n(497),a=n(493),l=n(491),c=n(495),p=n(175),h=n(562),g=n(502),d=n(221),f=n(222),y=n(494),m=n(492),b=n(52),x=n(220);t.GrammarsImportedLocally=h.Grammars,t.doMagicBoxExport=function e(){i.exportGlobally({MagicBox:{EndOfInputResult:b.EndOfInputResult,ExpressionConstant:s.ExpressionConstant,ExpressionEndOfInput:o.ExpressionEndOfInput,ExpressionFunction:r.ExpressionFunction,ExpressionList:u.ExpressionList,ExpressionOptions:a.ExpressionOptions,ExpressionRef:l.ExpressionRef,ExpressionRegExp:c.ExpressionRegExp,Grammar:p.Grammar,Grammars:h.Grammars,InputManager:g.InputManager,Instance:d.MagicBoxInstance,OptionResult:y.OptionResult,RefResult:m.RefResult,Result:b.Result,SuggestionsManager:x.SuggestionsManager,Utils:f.MagicBoxUtils,create:d.createMagicBox,requestAnimationFrame:d.requestAnimationFrame}})}},562:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(132),s=n(506),o=n(499),r=n(507),u=n(219),a=n(498),l=n(500),c=n(501);t.Grammars={Basic:i.Basic,notInWord:i.notInWord,notWordStart:i.notWordStart,Complete:s.Complete,Date:o.Date,Expressions:r.Expressions,ExpressionsGrammar:r.ExpressionsGrammar,Field:u.Field,NestedQuery:a.NestedQuery,QueryExtension:l.QueryExtension,SubExpression:c.SubExpression}},563:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(s,o){function r(e){try{a(i.next(e))}catch(t){o(t)}}function u(e){try{a(i.throw(e))}catch(t){o(t)}}function a(e){e.done?s(e.value):new n(function(t){t(e.value)}).then(r,u)}a((i=i.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var n,i,s,o,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function o(u){if(n)throw TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=i[2&u[0]?"return":u[0]?"throw":"next"])&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[0,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(!(s=(s=r.trys).length>0&&s[s.length-1])&&(6===u[0]||2===u[0])){r=0;continue}if(3===u[0]&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(6===u[0]&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(a){u=[6,a],i=0}finally{n=s=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=n(6),u=n(0),a=n(7),l=n(220),c=n(508),p=n(503),h=n(4),g=function(){function e(e,t){void 0===t&&(t={}),this.element=e,this.options=u.defaults(t,{previewHeaderText:r.l("QuerySuggestPreview"),previewHeaderFieldText:r.l("QuerySuggestPreviewWithField"),previewClass:"coveo-preview-selectable",selectedClass:"magic-box-selected"}),this.root=a.Component.resolveRoot(e),this.previewsProcessor=new p.QueryProcessor({timeout:this.options.timeout})}return Object.defineProperty(e.prototype,"previewsOwner",{get:function(){return this.lastDisplayedSuggestion},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasPreviews",{get:function(){return!!this.suggestionsPreviewContainer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"focusedPreviewElement",{get:function(){if(!this.hasPreviews)return null;var e=this.suggestionsPreviewContainer.findClass(this.options.selectedClass)[0];return e&&e.classList.contains(this.options.previewClass)?e:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previewElements",{get:function(){return this.hasPreviews?this.suggestionsPreviewContainer.findClass(this.options.previewClass):[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"suggestionsListbox",{get:function(){return o.$$(o.$$(this.element).findClass("coveo-magicbox-suggestions")[0])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberOfResultsPerRow",{get:function(){var e=this.suggestionsPreviewContainer.findClass(this.options.previewClass);if(0===e.length)return 0;var t=e[0].offsetTop,n=u.findIndex(e,function(e){return e.offsetTop!==t});return -1!==n?n:e.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previewContainerId",{get:function(){return"coveo-previews-for-"+this.lastDisplayedSuggestion.dom.id},enumerable:!0,configurable:!0}),e.prototype.displaySearchResultPreviewsForSuggestion=function(e){return i(this,void 0,void 0,function(){var t,n,i,o,r,u,a;return s(this,function(s){switch(s.label){case 0:return t=this.getExternalOptions(),[4,n=this.lastDelay=h.Utils.resolveAfter(h.Utils.isNullOrUndefined(t.displayAfterDuration)?200:t.displayAfterDuration)];case 1:if(s.sent(),n!==this.lastDelay||(i=e&&this.lastQueriedSuggestion===e))return[2];if(o=this.lastDisplayedSuggestion===e)return this.previewsProcessor.overrideIfProcessing(),this.lastQueriedSuggestion=null,[2];if(this.lastQueriedSuggestion=e,!e)return this.displaySuggestionPreviews(null,[]),[2];return[4,this.getSearchResultPreviewsQuery(e)];case 2:if(u=(r=s.sent()).status,a=r.results,u===p.ProcessingStatus.Overriden)return[2];return this.lastQueriedSuggestion=null,this.displaySuggestionPreviews(e,a),[2]}})})},e.prototype.getElementInDirection=function(e){var t=this.previewElements,n=t.indexOf(this.focusedPreviewElement);return -1===n||0===n&&e===l.Direction.Left?null:t[(n+this.getIncrementInDirection(e))%t.length]},e.prototype.getIncrementInDirection=function(e){switch(e){case l.Direction.Left:return -1;case l.Direction.Right:return 1;case l.Direction.Up:return-this.numberOfResultsPerRow;case l.Direction.Down:return this.numberOfResultsPerRow}},e.prototype.setHasPreviews=function(e){!!e!==this.hasPreviews&&(e?this.initPreviewForSuggestions():this.revertPreviewForSuggestions())},e.prototype.initPreviewForSuggestions=function(){this.suggestionsPreviewContainer=o.$$("div",{className:"coveo-suggestion-container"},this.suggestionsListbox.el,this.buildPreviewContainer()),this.element.appendChild(this.suggestionsPreviewContainer.el),this.suggestionsListbox.setAttribute("aria-controls",this.previewContainerId)},e.prototype.revertPreviewForSuggestions=function(){this.element.appendChild(this.suggestionsListbox.el),this.suggestionsPreviewContainer.remove(),this.suggestionsPreviewContainer=null},e.prototype.buildPreviewContainer=function(){return o.$$("div",{className:"coveo-preview-container",id:this.previewContainerId},this.resultPreviewsContainer=o.$$("div",{className:"coveo-preview-results",role:"listbox","aria-orientation":"horizontal"})).el},e.prototype.getExternalOptions=function(){var e={};return o.$$(this.root).trigger(c.ResultPreviewsManagerEvents.updateResultPreviewsManagerOptions,e),e},e.prototype.getSearchResultPreviewsQuery=function(e){var t={suggestion:e,previewsQueries:[]};return o.$$(this.root).trigger(c.ResultPreviewsManagerEvents.populateSearchResultPreviews,t),this.previewsProcessor.processQueries(t.previewsQueries)},e.prototype.appendSearchResultPreview=function(e,t){this.resultPreviewsContainer.append(e.element),e.element.id="coveo-result-preview-"+t;var n=o.$$(e.element);n.setAttribute("aria-selected","false"),n.setAttribute("role","option"),n.on("click",function(){return e.onSelect()}),n.on("keyboardSelect",function(){return e.onSelect()})},e.prototype.appendSearchResultPreviews=function(e){var t=this;this.resultPreviewsContainer.empty(),e.forEach(function(e,n){return t.appendSearchResultPreview(e,n)})},e.prototype.displaySuggestionPreviews=function(e,t){this.lastDisplayedSuggestion=e,this.setHasPreviews(t&&t.length>0),this.element.classList.toggle("magic-box-hasPreviews",this.hasPreviews),this.hasPreviews&&this.appendSearchResultPreviews(t)},e}();t.ResultPreviewsManager=g},564:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),s=n(6),o=n(15),r=function(){function e(e){this.element=i.$$("div",{className:"magic-box-clear"});var t=i.$$("div",{className:"magic-box-icon"});this.element.append(t.el),this.element.insertAfter(i.$$(e.element).find("input")),new o.AccessibleButton().withElement(this.element).withLabel(s.l("Clear")).withSelectAction(function(){return e.clear()}).build(),this.toggleTabindexAndAriaHidden(!1)}return e.prototype.toggleTabindexAndAriaHidden=function(e){this.element.setAttribute("tabindex",e?"0":"-1"),this.element.setAttribute("aria-hidden",""+!e)},e}();t.MagicBoxClear=r},565:function(e,t){},573:function(e,t){},574:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(34),s=n(0),o=n(222),r=function(){function e(e){var t=this;this.omnibox=e,this.cache={},this.omnibox.bind.on(this.omnibox.element,i.OmniboxEvents.populateOmniboxSuggestions,function(e){e.suggestions.push(t.getSuggestion())})}return e.prototype.getSuggestion=function(){var e,t=this,n=this.getHash();if(null==n)return null;var i=this.hashToString(n);return null!=this.cache[i]?this.hashValueToSuggestion(n,this.cache[i]):("FieldName"==n.type&&(e=this.fieldNames(n.current)),"FieldValue"==n.type&&(e=this.fieldValues(n.field,n.current)),"SimpleFieldName"==n.type&&(e=this.simpleFieldNames(n.current)),this.cache[i]=e,e.catch(function(){delete t.cache[i]}),this.hashValueToSuggestion(n,e))},e.prototype.getHash=function(){var e=s.last(this.omnibox.resultAtCursor("FieldName"));if(null!=e){var t=(e=e.findParent("Field")||e).toString(),n=e.before(),i=e.after();return{type:"FieldName",current:t,before:n,after:i}}var o=s.last(this.omnibox.resultAtCursor("FieldValue"));if(o){var r=o.findParent("FieldQuery")||this.omnibox.options.enableSimpleFieldAddon&&o.findParent("FieldSimpleQuery");if(r){var u=r.find("FieldName").toString();this.omnibox.options.fieldAlias&&u in this.omnibox.options.fieldAlias&&(u=this.omnibox.options.fieldAlias[u]);var a=o.toString(),n=o.before(),i=o.after();return{type:"FieldValue",field:u,current:a,before:n,after:i}}}if(this.omnibox.options.enableSimpleFieldAddon){var l=s.last(this.omnibox.resultAtCursor("Word"));if(null!=l){var c=l.toString(),n=l.before(),i=l.after();return{type:"SimpleFieldName",current:c,before:n,after:i}}}},e.prototype.hashToString=function(e){return null==e?null:e.type+e.current+(e.field||"")},e.prototype.hashValueToSuggestion=function(t,n){return n.then(function(n){return s.map(n,function(i,s){return{text:t.before+(0==t.current.toLowerCase().indexOf(i.toLowerCase())?t.current+i.substr(t.current.length):i)+t.after,html:o.MagicBoxUtils.highlightText(i,t.current,!0),index:e.INDEX-s/n.length}})})},e.prototype.getFields=function(){var e=this;return null==this.fields&&(this.fields=new Promise(function(t,n){null!=e.omnibox.options.listOfFields?t(e.omnibox.options.listOfFields):e.omnibox.queryController.getEndpoint().listFields().then(function(e){t(s.chain(e).filter(function(e){return e.includeInQuery&&e.groupByField}).map(function(e){return e.name.substr(1)}).value())}).catch(function(){n()})})),this.fields},e.prototype.fieldNames=function(e){var t=(e.length>0&&"@"==e[0]?e.substr(1):e).toLowerCase();return this.getFields().then(function(n){var i=s.chain(n).map(function(e){var n=e.length>0&&"@"==e[0];return{index:e.toLowerCase().indexOf(t),field:n?e:"@"+e}}).filter(function(t){return -1!=t.index&&t.field.length>e.length}).sortBy("index").map(function(e){return e.field}).value();return s.first(i,5)})},e.prototype.fieldValues=function(e,t){return this.omnibox.queryController.getEndpoint().listFieldValues({pattern:".*"+t+".*",patternType:"RegularExpression",sortCriteria:"occurrences",field:"@"+e,maximumNumberOfValues:5}).then(function(e){return s.chain(e).map(function(e){return{index:e.value.toLowerCase().indexOf(t),value:e.value}}).filter(function(e){return e.value.length>t.length}).sortBy("index").map(function(e){return e.value.replace(/ /g,"\xa0")}).value()})},e.prototype.simpleFieldNames=function(e){var t=e.toLowerCase();return this.getFields().then(function(n){var i=s.chain(n).map(function(e){return{index:e.toLowerCase().indexOf(t),field:e+":"}}).filter(function(t){return -1!=t.index&&t.field.length>e.length}).sortBy("index").map(function(e){return e.field}).value();return s.first(i,5)})},e.INDEX=64,e}();t.FieldAddon=r},575:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(34),s=n(1),o=n(4),r=n(0),u=function(){function e(e){var t=this;this.omnibox=e,this.omnibox.bind.on(this.omnibox.element,i.OmniboxEvents.populateOmniboxSuggestions,function(e){r.each(t.getSuggestion(),function(t){e.suggestions.push(t)})})}return e.prototype.getSuggestion=function(){if(0==this.omnibox.magicBox.getText().length)return null;var e=this.buildPopulateOmniboxEventArgs();return s.$$(this.omnibox.root).trigger(i.OmniboxEvents.populateOmnibox,e),this.rowsToSuggestions(e.rows)},e.prototype.getCurrentQueryExpression=function(){var e=this.omnibox.getCursor(),t=this.omnibox.getText(),n=t.length,i=e,s=e;for(" "==t[i]&&i--;i>0&&" "!=t[i];)i--;for(;s<n&&" "!=t[s];)s++;return t.substring(i,s)},e.prototype.getRegexToSearch=function(e){return null==e&&(e=this.omnibox.getText()),RegExp(o.Utils.escapeRegexCharacter(e),"i")},e.prototype.getQueryExpressionBreakDown=function(){var e=this,t=[],n=this.omnibox.getText().split(" ");return r.each(n,function(n){t.push({word:n,regex:e.getRegexToSearch(n)})}),t},e.prototype.replace=function(e,t){this.omnibox.setText(this.omnibox.getText().replace(e,t))},e.prototype.clearCurrentExpression=function(){this.replace(this.getCurrentQueryExpression(),"")},e.prototype.insertAt=function(e,t){var n=this.omnibox.getText(),i=[n.slice(0,e),t,n.slice(e)].join("");this.omnibox.setText(i)},e.prototype.replaceCurrentExpression=function(e){this.replace(this.getCurrentQueryExpression(),e)},e.prototype.buildPopulateOmniboxEventArgs=function(){var e=this,t=this.getCurrentQueryExpression();return{rows:[],completeQueryExpression:{word:this.omnibox.getText(),regex:this.getRegexToSearch()},currentQueryExpression:{word:t,regex:this.getRegexToSearch(t)},allQueryExpressions:this.getQueryExpressionBreakDown(),cursorPosition:this.omnibox.getCursor(),clear:function(){e.omnibox.clear()},clearCurrentExpression:function(){e.clearCurrentExpression()},replace:function(t,n){e.replace(t,n)},replaceCurrentExpression:function(t){e.replaceCurrentExpression(t)},insertAt:function(t,n){e.insertAt(t,n)},closeOmnibox:function(){e.omnibox.magicBox.blur()}}},e.prototype.rowsToSuggestions=function(e){return r.map(e,function(e){return o.Utils.isNullOrUndefined(e.element)?o.Utils.isNullOrUndefined(e.deferred)?null:new Promise(function(t){e.deferred.then(function(e){null!=e.element?t([{dom:e.element,index:e.zIndex}]):t(null)})}):new Promise(function(t){t([{dom:e.element,index:e.zIndex}])})})},e}();t.OldOmniboxAddon=u},576:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(34),s=n(0),o=n(222),r=function(){function e(e){var t=this;this.omnibox=e,this.cache={},this.omnibox.bind.on(this.omnibox.element,i.OmniboxEvents.populateOmniboxSuggestions,function(e){e.suggestions.push(t.getSuggestion())})}return e.prototype.getSuggestion=function(){var e=this,t=this.getHash(this.omnibox.magicBox);if(null==t)return null;var n=this.hashToString(t);if(null!=this.cache[n])return this.hashValueToSuggestion(t,this.cache[n]);var i="QueryExtensionName"==t.type?this.names(t.current):this.attributeNames(t.name,t.current,t.used);return this.cache[n]=i,i.catch(function(){delete e.cache[n]}),this.hashValueToSuggestion(t,i)},e.prototype.getHash=function(e){var t=s.last(e.resultAtCursor("QueryExtension"));if(null!=t){var n=t.findAll("QueryExtensionArgument"),i=s.last(e.resultAtCursor("QueryExtensionName"));if(null!=i)return{type:"QueryExtensionName",current:i.toString(),before:i.before(),after:i.after()};if(null!=(i=s.last(e.resultAtCursor("QueryExtensionArgumentName")))){var o=s.chain(n).map(function(e){var t=e.find("QueryExtensionArgumentName");return t&&t.toString()}).compact().value(),r=t.find("QueryExtensionName").toString();return{type:"QueryExtensionArgumentName",current:i.toString(),before:i.before(),after:i.after(),name:r,used:o}}}return null},e.prototype.hashToString=function(e){return null==e?null:[e.type,e.current,e.name||"",e.used?e.used.join():""].join()},e.prototype.hashValueToSuggestion=function(t,n){return n.then(function(n){return s.map(n,function(i,s){return{html:o.MagicBoxUtils.highlightText(i,t.current,!0),text:t.before+i+t.after,index:e.INDEX-s/n.length}})})},e.prototype.getExtensions=function(){return null==this.extensions&&(this.extensions=this.omnibox.queryController.getEndpoint().extensions()),this.extensions},e.prototype.names=function(e){var t=e.toLowerCase();return this.getExtensions().then(function(e){var n=s.chain(e).map(function(e){return{index:e.name.toLowerCase().indexOf(t),extension:e.name}}).filter(function(e){return -1!=e.index&&e.extension.length>t.length}).sortBy("index").pluck("extension").value();return s.first(n,5)})},e.prototype.attributeNames=function(e,t,n){return this.getExtensions().then(function(i){var o=s.find(i,function(t){return t.name==e});return null==o?[]:s.filter(s.difference(o.argumentNames,n),function(e){return 0==e.indexOf(t)})})},e.prototype.hash=function(){},e.INDEX=62,e}();t.QueryExtensionAddon=r},577:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(s,o){function r(e){try{a(i.next(e))}catch(t){o(t)}}function u(e){try{a(i.throw(e))}catch(t){o(t)}}function a(e){e.done?s(e.value):new n(function(t){t(e.value)}).then(r,u)}a((i=i.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){var n,i,s,o,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function o(u){if(n)throw TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=i[2&u[0]?"return":u[0]?"throw":"next"])&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[0,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(!(s=(s=r.trys).length>0&&s[s.length-1])&&(6===u[0]||2===u[0])){r=0;continue}if(3===u[0]&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(6===u[0]&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(a){u=[6,a],i=0}finally{n=s=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),r=n(28),u=n(34),a=n(22),l=n(0),c=n(13),p=n(4),h=n(89),g=n(50),d=function(){function e(e){var t=this;this.omnibox=e,o.$$(this.omnibox.element).on(u.OmniboxEvents.populateOmniboxSuggestions,function(e,n){n.suggestions.push(t.getSuggestion())})}return e.suggestiontHtml=function(e){return e.highlighted.replace(/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g,function(e,t,n,i){var s,r="";return n&&(r="coveo-omnibox-hightlight"),i&&(r="coveo-omnibox-hightlight2"),(s=r?o.$$("span",{className:r}):o.$$("span")).text(t||n||i),s.el.outerHTML})},e.isPartialMatch=function(e){var t=a.StringUtils.match(e.highlighted,/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g),n=l.find(t,function(e){return null!=e[1]});return null==n||l.every(l.last(t,l.indexOf(t,n)-t.length),function(e){return null!=e[1]})},e.prototype.getSuggestion=function(){var e=this.omnibox.magicBox.getText();return e.length>=this.omnibox.options.querySuggestCharacterThreshold?this.getQuerySuggest(e):Promise.resolve([])},e.prototype.getQuerySuggest=function(t){return i(this,void 0,void 0,function(){var n,i,r,a;return s(this,function(s){switch(s.label){case 0:n={q:t,locale:this.locale,searchHub:this.searchHub,pipeline:this.pipeline,enableWordCompletion:this.enableWordCompletion,context:this.context,count:this.count,tab:this.tab,referrer:document.referrer,actionsHistory:this.actionsHistory,timezone:this.timezone,visitorId:this.visitorId,isGuestUser:this.isGuestUser},o.$$(this.omnibox.getBindings().searchInterface.element).trigger(u.OmniboxEvents.buildingQuerySuggest,{payload:n}),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.omnibox.queryController.getEndpoint().getQuerySuggest(n)];case 2:return i=s.sent(),[3,4];case 3:return r=s.sent(),[2,[]];case 4:return a=i.completions,o.$$(this.omnibox.getBindings().searchInterface.element).trigger(u.OmniboxEvents.querySuggestSuccess,{completions:a}),[2,l.map(a,function(t,n){return{html:e.suggestiontHtml(t),text:t.expression,index:e.INDEX-n/a.length,partial:e.isPartialMatch(t),executableConfidence:t.executableConfidence}})]}})})},Object.defineProperty(e.prototype,"tab",{get:function(){var e=this.omnibox.getBindings().queryStateModel.get(c.QUERY_STATE_ATTRIBUTES.T);if(p.Utils.isNonEmptyString(e))return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"locale",{get:function(){return String.locale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"searchHub",{get:function(){return this.omnibox.getBindings().componentOptionsModel.get(r.ComponentOptionsModel.attributesEnum.searchHub)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pipeline",{get:function(){return this.omnibox.getBindings().searchInterface.options.pipeline},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableWordCompletion",{get:function(){return this.omnibox.options.enableSearchAsYouType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this.omnibox.getBindings().searchInterface.getQueryContext()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){return this.omnibox.options.numberOfSuggestions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"actionsHistory",{get:function(){var e=h.buildHistoryStore().getHistory();return null==e?[]:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timezone",{get:function(){return this.omnibox.getBindings().searchInterface.options.timezone},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visitorId",{get:function(){return new g.AnalyticsInformation().clientId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isGuestUser",{get:function(){return this.omnibox.getBindings().queryController.getEndpoint().options.isGuestUser},enumerable:!0,configurable:!0}),e.INDEX=60,e}();t.QuerySuggestAddon=d;var f=function(){function e(){}return e.prototype.getSuggestion=function(){return Promise.resolve([])},e}();t.VoidQuerySuggestAddon=f},670:function(e,t){},671:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),s=function(){function e(){}return e.resize=function(e,t){var n=this,i=this.getSearchbox(e),s=this.getElementsToResize(e),o=this.getInput(e),r="height: "+t+"px";this.applyStyle(i,"height: "+t+"px; line-height: "+t+"px;"),this.applyStyle(o,"height: "+(t-2)+"px;"),s.forEach(function(e){n.applyStyle(e,r)})},e.applyStyle=function(e,t){e.style.cssText+=t},e.getSearchbox=function(e){return i.$$(e).find(".CoveoOmnibox")||i.$$(e).find(".CoveoQuerybox")},e.getElementsToResize=function(e){return[i.$$(e).find(".CoveoSearchButton"),i.$$(i.$$(e).find(".magic-box-input")).find("input"),i.$$(e).find(".magic-box-icon"),i.$$(e).find(".magic-box-clear"),i.$$(e).find(".magic-box-underlay")]},e.getInput=function(e){return i.$$(e).find(".magic-box-input")},e}();t.SearchBoxResize=s}});
//# sourceMappingURL=Searchbox.min__fe0db31be4bbf1405ce0.js.map